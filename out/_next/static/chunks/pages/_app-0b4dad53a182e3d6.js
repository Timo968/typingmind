(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[888],{91118:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/_app",function(){return r(37148)}])},76606:function(e,t,r){"use strict";r.d(t,{Z:function(){return E},m:function(){return g}});var n=r(85893),a=r(67294),i=r(14364),o=r(78672),s=r(31955);let c="Something went wrong. Please try again.",d=(0,a.createContext)(),u=(0,o.eK)("useSyncStats"),l=(0,o.eK)("useFolderList"),p=(0,o.eK)("useDeletedFolderIDs"),h=(0,o.eK)("useDeletedChatIDs"),y=(0,o.eK)("useTMCloudEnabled"),f=(0,o.eK)("useUserPrompts"),m=(0,o.eK)("useDeletedPromptIDs"),w=(0,o.eK)("useChatsInFolder"),g=()=>(0,a.useContext)(d);function E(e){let{children:t}=e,[r,g]=u(null),[E,A]=(0,a.useState)(!1),[v,S]=(0,a.useState)(null),[b,_]=l([]),[H,k]=p([]),[C,P]=h([]),[I,K]=y(!1),[T,W]=(0,a.useState)("init"),[J,D]=f([]),[R,x]=m([]),[O,U]=w({}),M=(0,a.useRef)(null),N=(0,a.useRef)(null);(0,a.useEffect)(()=>()=>{clearTimeout(M.current)},[]);let j=()=>{if(!I)return;let e=s.Z.get("typingmindcloud_token");e&&(M.current&&clearTimeout(M.current),M.current=setTimeout(()=>{N.current||(N.current=B().then(()=>{N.current=null}))},1e3),W("scheduled"))},F=()=>G(new Date(0),{resync:!0}),B=()=>G((null==r?void 0:r.lastSyncAt)||new Date(0)),G=(0,a.useCallback)(async function(e){let{resync:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{W("started");let r=(0,i.ZP)({resync:t});A(!0),S("");let n=await fetch((0,i.v9)()+"/api/sync",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+s.Z.get("typingmindcloud_token")},body:JSON.stringify({allData:r,lastSyncAt:e})});if(n.status>=400){let e=await n.json();S(e.userMessage||c),A(!1);return}if(!n.ok){S(c),A(!1);return}let a=await n.json(),{updatedChats:d,updatedFolders:u,updatedPrompts:l,newToken:p}=a;if(p&&s.Z.set("typingmindcloud_token",p,{expires:30}),d&&d.length){let e=d.map(e=>({...e.data,deletedAt:e.deletedAt}));e.forEach(e=>{if(e.deletedAt)(0,o.cF)().removeItem("CHAT_"+e.chatID);else{let t=JSON.parse((0,o.cF)().getItem("CHAT_"+e.chatID));if(t&&null===t.syncedAt)return;(0,o.cF)().setItem("CHAT_"+e.chatID,JSON.stringify(e))}});let t=(0,i.FW)(e),r=JSON.parse((0,o.cF)().getItem("TM_useChatList")||"[]"),n=[...t,...r],a=n.filter((e,t,r)=>t===r.findIndex(t=>t.chatID===e.chatID)).filter(e=>!e.deletedAt);(0,o.cF)().setItem("TM_useChatList",JSON.stringify(a)),U(e=>{let t=JSON.parse(JSON.stringify(e));for(let e of d){let r=e.data;if(!r.deletedAt){if(r.folderID)t[r.folderID]||(t[r.folderID]=[]),t[r.folderID].push(r.chatID);else for(let e in t){let n=t[e];if(!n||!Array.isArray(n))continue;let a=n.indexOf(r.chatID);a>-1&&n.splice(a,1)}}}return t})}if(u&&u.length){let e=JSON.parse((0,o.cF)().getItem("TM_useFolderList")||"[]"),t=[...u.map(e=>({...e.data,deletedAt:e.deletedAt})),...e],r=JSON.parse((0,o.cF)().getItem("TM_useDeletedFolderIDs")||"[]"),n=t.filter((e,t,r)=>t===r.findIndex(t=>t.id===e.id)).filter(e=>!e.deletedAt).filter(e=>-1===r.indexOf(e.id)),a=n.map(e=>({...e,chatIDs:void 0}));a.sort((e,t)=>e.order-t.order),_(a)}if(l&&l.length){let e=JSON.parse((0,o.cF)().getItem("TM_useUserPrompts")||"[]"),t=[...l.map(e=>({...e.data,deletedAt:e.deletedAt})),...e],r=t.filter((e,t,r)=>t===r.findIndex(t=>t.id===e.id)).filter(e=>!e.deletedAt).filter(e=>-1===R.indexOf(e.id));D(r)}k([]),P([]),g({lastSyncAt:a.lastSyncAt}),W("ready")}catch(e){console.error(e),S("Sorry, there has been a problem with the sync process. Open the Console might clarify the issue."),W("error")}A(!1)},[I,g,_,k,P]),L=(0,a.useMemo)(()=>({syncLoading:E,syncError:v,syncStats:r,setSyncStats:g,sync:B,reSyncEverything:F,scheduleSync:j,syncStatus:T}),[E,v,r,g,B,j,T]);return(0,n.jsx)(d.Provider,{value:L,children:t})}},4510:function(e,t,r){"use strict";r.d(t,{NZ:function(){return s},ZP:function(){return c},yZ:function(){return i}});var n=r(85893),a=r(67294);let i={OK:"OK",SLOW:"SLOW",ERROR:"ERROR"},o=(0,a.createContext)(),s=()=>(0,a.useContext)(o);function c(e){let{children:t}=e,[r,s]=(0,a.useState)(i.OK),c=(0,a.useMemo)(()=>({openAIStatus:r,setOpenAIStatus:s}),[r]);return(0,n.jsx)(o.Provider,{value:c,children:t})}},37148:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return u}});var n=r(85893);r(82488);var a=r(67294),i=()=>{window.va||(window.va=function(...e){(window.vaq=window.vaq||[]).push(e)})},o=(e={debug:!0})=>{var t;if(!("undefined"!=typeof window))return;let r=function(e="auto"){return"auto"===e?!function(){try{return!1}catch(e){return!1}}()?"production":"development":e}(e.mode);i(),e.beforeSend&&(null==(t=window.va)||t.call(window,"beforeSend",e.beforeSend));let n="development"===r?"https://cdn.vercel-insights.com/v1/script.debug.js":"/_vercel/insights/script.js";if(document.head.querySelector(`script[src*="${n}"]`))return;let a=document.createElement("script");a.src=n,a.defer=!0,a.setAttribute("data-sdkn","@vercel/analytics"),a.setAttribute("data-sdkv","0.1.11"),"development"===r&&!1===e.debug&&a.setAttribute("data-debug","false"),document.head.appendChild(a)};function s({beforeSend:e,debug:t=!0,mode:r="auto"}){return(0,a.useEffect)(()=>{o({beforeSend:e,debug:t,mode:r})},[e,t,r]),null}var c=r(4510),d=r(76606),u=function(e){let{Component:t,pageProps:r}=e;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(d.Z,{children:(0,n.jsx)(c.ZP,{children:(0,n.jsx)(t,{...r})})}),(0,n.jsx)(s,{})]})}},78672:function(e,t,r){"use strict";r.d(t,{eK:function(){return l},NW:function(){return h},cF:function(){return p}});var n=r(67294);let a={},i=(e,t,r)=>(a[e]||(a[e]={callbacks:[],value:r}),a[e].callbacks.push(t),{deregister(){let r=a[e].callbacks,n=r.indexOf(t);n>-1&&r.splice(n,1)},emit(r){a[e].value!==r&&(a[e].value=r,a[e].callbacks.forEach(e=>{t!==e&&e(r)}))}}),o=(e,t,a)=>{var o,s,c,d,u,l,p,h;let{get:y,set:f}=a,m=(0,n.useRef)(null),[w,g]=(0,n.useState)(()=>y(t,e));o="storage",s=r=>{let{key:n,newValue:a}=r;if(n===t){let t;try{t=JSON.parse(a)}catch(r){console.error("usePersistedState failed to parse",r,a),t=e}w!==t&&g(t)}},void 0===c&&(c=r.g),void 0===d&&(d={}),u=(0,n.useRef)(),l=d.capture,p=d.passive,h=d.once,(0,n.useEffect)(function(){u.current=s},[s]),(0,n.useEffect)(function(){if(c&&c.addEventListener){var e=function(e){return u.current(e)},t={capture:l,passive:p,once:h};return c.addEventListener(o,e,t),function(){c.removeEventListener(o,e,t)}}},[o,c,l,p,h]),(0,n.useEffect)(()=>(m.current=i(t,g,w),()=>{m.current.deregister()}),[e,t]);let E=(0,n.useCallback)(e=>{"function"==typeof e?g(r=>{let n=e(r);return f(t,n),m.current.emit(n),n}):(f(t,e),g(e),m.current.emit(e))},[w,f,t]);return[w,E]},s=(e,t)=>{try{return JSON.parse(e)}catch(e){return t}},c=e=>({get(t,r){let n=e.getItem(t),a="function"==typeof r?r():r;return null==n?a:s(n,a)},set(t,r){e.setItem(t,JSON.stringify(r))}}),d=()=>void 0!==r.g&&r.g.localStorage?r.g.localStorage:"undefined"!=typeof globalThis&&globalThis.localStorage?globalThis.localStorage:window.localStorage?window.localStorage:"undefined"!=typeof localStorage?localStorage:null;var u=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:d();if(t){let r=c(t);return t=>o(t,e,r)}return n.useState};let l=e=>{let t=u("TM_"+e);return t},p=()=>window.localStorage,h=()=>Object.keys(window.localStorage)},14364:function(e,t,r){"use strict";r.d(t,{FW:function(){return y},Jp:function(){return g},M:function(){return p},Q6:function(){return u},Ri:function(){return s},ZP:function(){return w},b1:function(){return c},cl:function(){return d},dC:function(){return m},nF:function(){return E},uM:function(){return l},v9:function(){return f},z9:function(){return h}});var n=r(67294),a=r(83991),i=r(78672);let o=r(62136),s=[{id:"1",title:"Fix Grammar Errors",description:"Fix grammar errors in the text",prompt:"Fix all the grammar errors in the text below. Only fix grammar errors, do not change the text style. Then explain the grammar errors in a list format.\n\n{{your content here}}",source:"Tony Dinh"},{id:"2",title:"Act as an English Translator and Improver",prompt:'I want you to act as an English translator, spelling corrector and improver. I will speak to you in any language and you will detect the language, translate it and answer in the corrected and improved version of my text, in English. I want you to replace my simplified A0-level words and sentences with more beautiful and elegant, upper level English words and sentences. Keep the meaning same, but make them more literary. I want you to only reply the correction, the improvements and nothing else, do not write explanations. My first sentence is "{{your content here}}"',source:"github.com/f/awesome-chatgpt-prompts"},{id:"3",title:"Act as an job interviewer",prompt:'I want you to act as an interviewer. I will be the candidate and you will ask me the interview questions for the {{position}} position. I want you to only reply as the interviewer. Do not write all the conservation at once. I want you to only do the interview with me. Ask me the questions and wait for my answers. Do not write explanations. Ask me the questions one by one like an interviewer does and wait for my answers. My first sentence is "Hi"',source:"github.com/f/awesome-chatgpt-prompts"},{id:"4",title:"Act as a English Pronunciation Helper",prompt:'I want you to act as an English pronunciation assistant for Turkish speaking people. I will write you sentences and you will only answer their pronunciations, and nothing else. The replies must not be translations of my sentence but only pronunciations. Pronunciations should use Turkish Latin letters for phonetics. Do not write explanations on replies. My first sentence is "{{your content}}"',source:"github.com/f/awesome-chatgpt-prompts"},{id:"5",title:"Act as a Travel Guide",prompt:'I want you to act as a travel guide. I will write you my location and you will suggest a place to visit near my location. In some cases, I will also give you the type of places I will visit. You will also suggest me places of similar type that are close to my first location. My first suggestion request is "{{your request}}"',source:"github.com/f/awesome-chatgpt-prompts"},{id:"6",title:"Act as a Storyteller",prompt:'I want you to act as a storyteller. You will come up with entertaining stories that are engaging, imaginative and captivating for the audience. It can be fairy tales, educational stories or any other type of stories which has the potential to capture people\'s attention and imagination. Depending on the target audience, you may choose specific themes or topics for your storytelling session e.g., if it’s children then you can talk about animals; If it’s adults then history-based tales might engage them better etc. My first request is "{{your request}}"',source:"github.com/f/awesome-chatgpt-prompts"},{id:"7",title:"Act as a Stand-up Comedian",prompt:'I want you to act as a stand-up comedian. I will provide you with some topics related to current events and you will use your wit, creativity, and observational skills to create a routine based on those topics. You should also be sure to incorporate personal anecdotes or experiences into the routine in order to make it more relatable and engaging for the audience. My first request is "{{I want an humorous take on politics.}}"',source:"github.com/f/awesome-chatgpt-prompts"},{id:"8",title:"Act as a Motivational Coach",prompt:'I want you to act as a motivational coach. I will provide you with some information about someone\'s goals and challenges, and it will be your job to come up with strategies that can help this person achieve their goals. This could involve providing positive affirmations, giving helpful advice or suggesting activities they can do to reach their end goal. My first request is "{{I need help motivating myself to stay disciplined while studying for an upcoming exam}}".',source:"github.com/f/awesome-chatgpt-prompts"},{id:"9",title:"Act as a Composer",prompt:'I want you to act as a composer. I will provide the lyrics to a song and you will create music for it. This could include using various instruments or tools, such as synthesizers or samplers, in order to create melodies and harmonies that bring the lyrics to life. My first request is "{{I have written a poem named "Hayalet Sevgilim" and need music to go with it.}}"',source:"github.com/f/awesome-chatgpt-prompts"},{id:"10",title:"Act as a Screenwriter",prompt:'I want you to act as a screenwriter. You will develop an engaging and creative script for either a feature length film, or a Web Series that can captivate its viewers. Start with coming up with interesting characters, the setting of the story, dialogues between the characters etc. Once your character development is complete - create an exciting storyline filled with twists and turns that keeps the viewers in suspense until the end. My first request is "{{I need to write a romantic drama movie set in Paris.}}"',source:"github.com/f/awesome-chatgpt-prompts"},{id:"11",title:"Act as a Rapper",prompt:'I want you to act as a rapper. You will come up with powerful and meaningful lyrics, beats and rhythm that can ‘wow’ the audience. Your lyrics should have an intriguing meaning and message which people can relate too. When it comes to choosing your beat, make sure it is catchy yet relevant to your words, so that when combined they make an explosion of sound everytime! My first request is "{{I need a rap song about finding strength within yourself.}}"',source:"github.com/f/awesome-chatgpt-prompts"},{id:"12",title:"Act as an AI Writing Tutor",prompt:'I want you to act as an AI writing tutor. I will provide you with a student who needs help improving their writing and your task is to use artificial intelligence tools, such as natural language processing, to give the student feedback on how they can improve their composition. You should also use your rhetorical knowledge and experience about effective writing techniques in order to suggest ways that the student can better express their thoughts and ideas in written form. My first request is "{{I need somebody to help me edit my master\'s thesis.}}"',source:"github.com/f/awesome-chatgpt-prompts"},{id:"13",title:"Act as a UX/UI Developer",prompt:'I want you to act as a UX/UI developer. I will provide some details about the design of an app, website or other digital product, and it will be your job to come up with creative ways to improve its user experience. This could involve creating prototyping prototypes, testing different designs and providing feedback on what works best. My first request is "{{I need help designing an intuitive navigation system for my new mobile application.}}"',source:"github.com/f/awesome-chatgpt-prompts"}];function c(){return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0}let d="You are ChatGPT, a large language model trained by OpenAI.",u="gpt-3.5-turbo",l=async e=>{let t=await o.importSPKI("-----BEGIN PUBLIC KEY-----\nMIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEAqs5NRfqiAmZf4Eg3TKsT\n9lpFpof6ZfQ+o7wiHbqKjXdz/yUez/2TxEMmisq3sNlwbAEqseIiPHD507UTi4b3\nfAXqDByrNrmyMIYg/UUpjRbuui1bOzHDVLqE4fFbVUvv4XacJmirAH8m6NUKHAIo\ns8IebpCVIgrn3PUayA52wUU3FhRfHti6gyaOj85jTJh/8c2vtlxC9tYf67s9tbFD\nM3mGSwQAiAb6ozooG8vhiQB0szFq7y4pVS5bF6fk2VAlwy7uIzRGjrk6Vz6mxQLu\nUsqvtBKREp/0mdR2EC2iXyQcfLSVJCDgaEMbvS8ByrKHkLMkePeVeI19KXaIpp+p\nWk6SuNrw4ClxrJe0uU63peOMmtGvUCEnI86k9Aui4x7cvT2Ken9weG7L7zdFfFR8\nwd776L3rtSowMU0s5Vi/dS4Sx74J82uQAe3cY7ZffmwBcb6LKC6HiaDwjBcI/T2L\ngth1iy4P+oEm0HIEsqv7Y3XSkc1qzC4AZ4kfW6/7AeUqBs7VVC8gQNMhM255EYwl\nms6qFJdgy3mNKVBNc3Qxw2JZoOwXivJHU+OVxosl8W0wnsXpLXPhP1A7XcnxkR40\nKR8rnrP+arHGHxHx28zJ3NeEIOiA3YmD5jpQ90BPccZTZtHfzao+jkYNWZdHRnjS\nylbW/odEgbmqTW7DJxavY/MCAwEAAQ==\n-----END PUBLIC KEY-----","RS256"),{payload:r,protectedHeader:n}=await o.jwtVerify(e,t,{issuer:"urn:typingmind:issuer",audience:"urn:typingmind:audience"});return{payload:r,protectedHeader:n}},p=e=>{let t=0;for(let r=0;r<e.length;r++){let n=e.charCodeAt(r);t=(t<<5)-t+n,t&=t}return new Uint32Array([t])[0].toString(36)},h=()=>{let e=(0,n.useRef)(!0);return(0,n.useEffect)(()=>{e.current=!1},[]),e.current},y=e=>e.map(e=>{try{var t,r;let n=e.messages;return{...e,preview:(null===(t=n[n.length-1])||void 0===t?void 0:null===(r=t.content)||void 0===r?void 0:r.substring(0,50))||"",id:e.chatID,messages:null,title:e.chatTitle}}catch(e){return console.error(e),null}}).filter(Boolean),f=()=>"https://cloud.typingmind.com",m=e=>{try{return JSON.parse(e)}catch(e){return null}},w=function(){let{resync:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e=>a.f.map(e=>e.chatID).includes(e),r=m((0,i.cF)().getItem("TM_useChatsInFolder")),n={};Object.keys(r||{}).forEach(e=>{r[e].forEach(t=>{n[t]=e})});let o=(0,i.NW)().filter(e=>e.startsWith("CHAT_")).map(e=>{let t=m((0,i.cF)().getItem(e));return t&&"CHAT_"+t.chatID===e?(void 0===t.folderID&&(t.folderID=n[t.chatID]||null),t):null}).filter(Boolean).filter(e=>!t(e.chatID)).filter(t=>e||!t.syncedAt),s=m(localStorage.getItem("TM_useDeletedChatIDs"))||[],c=(m((0,i.cF)().getItem("TM_useFolderList"))||[]).filter(t=>e||!t.syncedAt),d=m((0,i.cF)().getItem("TM_useDeletedFolderIDs"))||[],u=m((0,i.cF)().getItem("TM_useDeletedPromptIDs"))||[],l=(m((0,i.cF)().getItem("TM_useUserPrompts"))||[]).filter(t=>e||!t.syncedAt);return{chats:o,deletedChatIDs:s,folders:c,deletedFolderIDs:d,userPrompts:l,deletedPromptIDs:u}},g=e=>"Rules:\n- You are an AI assistant.\n- You will be provided a text document\n- You will answer the user questions based on the content from the document.\n- You refuse to answer any question that is not in the document.\n- You only answer if you are confident that the answer is accurate based on the information provided in the document.\n- If you are not confident about the answer, you say sorry to the user and refuse to answer.\n\nHere is the document:\n\n---\n".concat(e,"\n---\n\nNow the user will ask you a question."),E=function(e){var t,r;let{chatID:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a={"gpt-4":{prompt:.03,completion:.06},"gpt-4-0314":{prompt:.03,completion:.06},"gpt-4-32k":{prompt:.06,completion:.12},"gpt-4-32k-0314":{prompt:.06,completion:.12},"gpt-3.5-turbo":{prompt:.002,completion:.002},"gpt-3.5-turbo-0301":{prompt:.002,completion:.002}},i=0,o=0,s=0,c=0,d=0,u=0,l=n?e.filter(e=>e.chatID===n):e;l.forEach(e=>{let{model:t,usage:r,type:n}=e||{};if(!t||!r||!n)return;let{completion_tokens:l=0,prompt_tokens:p=0}=r||{},{prompt:h,completion:y}=a[t]||a["gpt-3.5-turbo"];i+=l+p;let f=p*h/1e3+l*y/1e3;o+=f,"message"===n?(s+=l+p,c+=f):(d+=l+p,u+=f)});let p=(null===(t=e[0])||void 0===t?void 0:t.recordedAt)?new Date(null===(r=e[0])||void 0===r?void 0:r.recordedAt):null;return{totalCostUSD:o,totalTokens:i,enhancedTokens:d,enhancedCostUSD:u,startDate:p,messageTokens:s,messageCostUSD:c}}},82488:function(){},62136:function(e,t,r){"use strict";r.r(t),r.d(t,{CompactEncrypt:function(){return ty},CompactSign:function(){return tw},EmbeddedJWK:function(){return tk},EncryptJWT:function(){return tS},FlattenedEncrypt:function(){return e6},FlattenedSign:function(){return tm},GeneralEncrypt:function(){return e3},GeneralSign:function(){return tE},SignJWT:function(){return tv},UnsecuredJWT:function(){return tR},base64url:function(){return a},calculateJwkThumbprint:function(){return t_},calculateJwkThumbprintUri:function(){return tH},compactDecrypt:function(){return eX},compactVerify:function(){return tr},createLocalJWKSet:function(){return tT},createRemoteJWKSet:function(){return tD},decodeJwt:function(){return tM},decodeProtectedHeader:function(){return tU},errors:function(){return n},exportJWK:function(){return e1},exportPKCS8:function(){return e2},exportSPKI:function(){return e0},flattenedDecrypt:function(){return eq},flattenedVerify:function(){return tt},generalDecrypt:function(){return eZ},generalVerify:function(){return tn},generateKeyPair:function(){return tB},generateSecret:function(){return tG},importJWK:function(){return eU},importPKCS8:function(){return eO},importSPKI:function(){return eR},importX509:function(){return ex},jwtDecrypt:function(){return th},jwtVerify:function(){return tp}});var n={};r.r(n),r.d(n,{JOSEAlgNotAllowed:function(){return b},JOSEError:function(){return A},JOSENotSupported:function(){return _},JWEDecryptionFailed:function(){return H},JWEInvalid:function(){return k},JWKInvalid:function(){return I},JWKSInvalid:function(){return K},JWKSMultipleMatchingKeys:function(){return W},JWKSNoMatchingKey:function(){return T},JWKSTimeout:function(){return J},JWSInvalid:function(){return C},JWSSignatureVerificationFailed:function(){return D},JWTClaimValidationFailed:function(){return v},JWTExpired:function(){return S},JWTInvalid:function(){return P}});var a={};r.r(a),r.d(a,{decode:function(){return tO},encode:function(){return tx}});var i=crypto;let o=e=>e instanceof CryptoKey,s=async(e,t)=>{let r=`SHA-${e.slice(-3)}`;return new Uint8Array(await i.subtle.digest(r,t))},c=new TextEncoder,d=new TextDecoder;function u(...e){let t=e.reduce((e,{length:t})=>e+t,0),r=new Uint8Array(t),n=0;return e.forEach(e=>{r.set(e,n),n+=e.length}),r}function l(e,t,r){if(t<0||t>=4294967296)throw RangeError(`value must be >= 0 and <= ${4294967296-1}. Received ${t}`);e.set([t>>>24,t>>>16,t>>>8,255&t],r)}function p(e){let t=new Uint8Array(8);return l(t,Math.floor(e/4294967296),0),l(t,e%4294967296,4),t}function h(e){let t=new Uint8Array(4);return l(t,e),t}function y(e){return u(h(e.length),e)}async function f(e,t,r){let n=Math.ceil((t>>3)/32),a=new Uint8Array(32*n);for(let t=0;t<n;t++){let n=new Uint8Array(4+e.length+r.length);n.set(h(t+1)),n.set(e,4),n.set(r,4+e.length),a.set(await s("sha256",n),32*t)}return a.slice(0,t>>3)}let m=e=>{let t=e;"string"==typeof t&&(t=c.encode(t));let r=[];for(let e=0;e<t.length;e+=32768)r.push(String.fromCharCode.apply(null,t.subarray(e,e+32768)));return btoa(r.join(""))},w=e=>m(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"),g=e=>{let t=atob(e),r=new Uint8Array(t.length);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);return r},E=e=>{let t=e;t instanceof Uint8Array&&(t=d.decode(t)),t=t.replace(/-/g,"+").replace(/_/g,"/").replace(/\s/g,"");try{return g(t)}catch(e){throw TypeError("The input to be decoded is not correctly encoded.")}};class A extends Error{static get code(){return"ERR_JOSE_GENERIC"}constructor(e){var t;super(e),this.code="ERR_JOSE_GENERIC",this.name=this.constructor.name,null===(t=Error.captureStackTrace)||void 0===t||t.call(Error,this,this.constructor)}}class v extends A{static get code(){return"ERR_JWT_CLAIM_VALIDATION_FAILED"}constructor(e,t="unspecified",r="unspecified"){super(e),this.code="ERR_JWT_CLAIM_VALIDATION_FAILED",this.claim=t,this.reason=r}}class S extends A{static get code(){return"ERR_JWT_EXPIRED"}constructor(e,t="unspecified",r="unspecified"){super(e),this.code="ERR_JWT_EXPIRED",this.claim=t,this.reason=r}}class b extends A{constructor(){super(...arguments),this.code="ERR_JOSE_ALG_NOT_ALLOWED"}static get code(){return"ERR_JOSE_ALG_NOT_ALLOWED"}}class _ extends A{constructor(){super(...arguments),this.code="ERR_JOSE_NOT_SUPPORTED"}static get code(){return"ERR_JOSE_NOT_SUPPORTED"}}class H extends A{constructor(){super(...arguments),this.code="ERR_JWE_DECRYPTION_FAILED",this.message="decryption operation failed"}static get code(){return"ERR_JWE_DECRYPTION_FAILED"}}class k extends A{constructor(){super(...arguments),this.code="ERR_JWE_INVALID"}static get code(){return"ERR_JWE_INVALID"}}class C extends A{constructor(){super(...arguments),this.code="ERR_JWS_INVALID"}static get code(){return"ERR_JWS_INVALID"}}class P extends A{constructor(){super(...arguments),this.code="ERR_JWT_INVALID"}static get code(){return"ERR_JWT_INVALID"}}class I extends A{constructor(){super(...arguments),this.code="ERR_JWK_INVALID"}static get code(){return"ERR_JWK_INVALID"}}class K extends A{constructor(){super(...arguments),this.code="ERR_JWKS_INVALID"}static get code(){return"ERR_JWKS_INVALID"}}class T extends A{constructor(){super(...arguments),this.code="ERR_JWKS_NO_MATCHING_KEY",this.message="no applicable key found in the JSON Web Key Set"}static get code(){return"ERR_JWKS_NO_MATCHING_KEY"}}class W extends A{constructor(){super(...arguments),this.code="ERR_JWKS_MULTIPLE_MATCHING_KEYS",this.message="multiple matching keys found in the JSON Web Key Set"}static get code(){return"ERR_JWKS_MULTIPLE_MATCHING_KEYS"}}class J extends A{constructor(){super(...arguments),this.code="ERR_JWKS_TIMEOUT",this.message="request timed out"}static get code(){return"ERR_JWKS_TIMEOUT"}}class D extends A{constructor(){super(...arguments),this.code="ERR_JWS_SIGNATURE_VERIFICATION_FAILED",this.message="signature verification failed"}static get code(){return"ERR_JWS_SIGNATURE_VERIFICATION_FAILED"}}var R=i.getRandomValues.bind(i);function x(e){switch(e){case"A128GCM":case"A128GCMKW":case"A192GCM":case"A192GCMKW":case"A256GCM":case"A256GCMKW":return 96;case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return 128;default:throw new _(`Unsupported JWE Algorithm: ${e}`)}}var O=e=>R(new Uint8Array(x(e)>>3));let U=(e,t)=>{if(t.length<<3!==x(e))throw new k("Invalid Initialization Vector length")},M=(e,t)=>{let r=e.byteLength<<3;if(r!==t)throw new k(`Invalid Content Encryption Key length. Expected ${t} bits, got ${r} bits`)},N=(e,t)=>{if(!(e instanceof Uint8Array))throw TypeError("First argument must be a buffer");if(!(t instanceof Uint8Array))throw TypeError("Second argument must be a buffer");if(e.length!==t.length)throw TypeError("Input buffers must have the same length");let r=e.length,n=0,a=-1;for(;++a<r;)n|=e[a]^t[a];return 0===n};function j(){return"undefined"!=typeof WebSocketPair||"undefined"!=typeof navigator&&"Cloudflare-Workers"===navigator.userAgent||"undefined"!=typeof EdgeRuntime&&"vercel"===EdgeRuntime}function F(e,t="algorithm.name"){return TypeError(`CryptoKey does not support this operation, its ${t} must be ${e}`)}function B(e,t){return e.name===t}function G(e){return parseInt(e.name.slice(4),10)}function L(e,t){if(t.length&&!t.some(t=>e.usages.includes(t))){let e="CryptoKey does not support this operation, its usages must include ";if(t.length>2){let r=t.pop();e+=`one of ${t.join(", ")}, or ${r}.`}else 2===t.length?e+=`one of ${t[0]} or ${t[1]}.`:e+=`${t[0]}.`;throw TypeError(e)}}function $(e,t,...r){switch(t){case"A128GCM":case"A192GCM":case"A256GCM":{if(!B(e.algorithm,"AES-GCM"))throw F("AES-GCM");let r=parseInt(t.slice(1,4),10),n=e.algorithm.length;if(n!==r)throw F(r,"algorithm.length");break}case"A128KW":case"A192KW":case"A256KW":{if(!B(e.algorithm,"AES-KW"))throw F("AES-KW");let r=parseInt(t.slice(1,4),10),n=e.algorithm.length;if(n!==r)throw F(r,"algorithm.length");break}case"ECDH":switch(e.algorithm.name){case"ECDH":case"X25519":case"X448":break;default:throw F("ECDH, X25519, or X448")}break;case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":if(!B(e.algorithm,"PBKDF2"))throw F("PBKDF2");break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":{if(!B(e.algorithm,"RSA-OAEP"))throw F("RSA-OAEP");let r=parseInt(t.slice(9),10)||1,n=G(e.algorithm.hash);if(n!==r)throw F(`SHA-${r}`,"algorithm.hash");break}default:throw TypeError("CryptoKey does not support this operation")}L(e,r)}function Y(e,t,...r){if(r.length>2){let t=r.pop();e+=`one of type ${r.join(", ")}, or ${t}.`}else 2===r.length?e+=`one of type ${r[0]} or ${r[1]}.`:e+=`of type ${r[0]}.`;return null==t?e+=` Received ${t}`:"function"==typeof t&&t.name?e+=` Received function ${t.name}`:"object"==typeof t&&null!=t&&t.constructor&&t.constructor.name&&(e+=` Received an instance of ${t.constructor.name}`),e}var z=(e,...t)=>Y("Key must be ",e,...t);function V(e,t,...r){return Y(`Key for the ${e} algorithm must be `,t,...r)}var q=e=>o(e);let X=["CryptoKey"];async function Z(e,t,r,n,a,o){let s,c;if(!(t instanceof Uint8Array))throw TypeError(z(t,"Uint8Array"));let d=parseInt(e.slice(1,4),10),l=await i.subtle.importKey("raw",t.subarray(d>>3),"AES-CBC",!1,["decrypt"]),h=await i.subtle.importKey("raw",t.subarray(0,d>>3),{hash:`SHA-${d<<1}`,name:"HMAC"},!1,["sign"]),y=u(o,n,r,p(o.length<<3)),f=new Uint8Array((await i.subtle.sign("HMAC",h,y)).slice(0,d>>3));try{s=N(a,f)}catch(e){}if(!s)throw new H;try{c=new Uint8Array(await i.subtle.decrypt({iv:n,name:"AES-CBC"},l,r))}catch(e){}if(!c)throw new H;return c}async function Q(e,t,r,n,a,o){let s;t instanceof Uint8Array?s=await i.subtle.importKey("raw",t,"AES-GCM",!1,["decrypt"]):($(t,e,"decrypt"),s=t);try{return new Uint8Array(await i.subtle.decrypt({additionalData:o,iv:n,name:"AES-GCM",tagLength:128},s,u(r,a)))}catch(e){throw new H}}let ee=async(e,t,r,n,a,i)=>{if(!o(t)&&!(t instanceof Uint8Array))throw TypeError(z(t,...X,"Uint8Array"));switch(U(e,n),e){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return t instanceof Uint8Array&&M(t,parseInt(e.slice(-3),10)),Z(e,t,r,n,a,i);case"A128GCM":case"A192GCM":case"A256GCM":return t instanceof Uint8Array&&M(t,parseInt(e.slice(1,4),10)),Q(e,t,r,n,a,i);default:throw new _("Unsupported JWE Content Encryption Algorithm")}},et=async()=>{throw new _('JWE "zip" (Compression Algorithm) Header Parameter is not supported by your javascript runtime. You need to use the `inflateRaw` decrypt option to provide Inflate Raw implementation.')},er=async()=>{throw new _('JWE "zip" (Compression Algorithm) Header Parameter is not supported by your javascript runtime. You need to use the `deflateRaw` encrypt option to provide Deflate Raw implementation.')},en=(...e)=>{let t;let r=e.filter(Boolean);if(0===r.length||1===r.length)return!0;for(let e of r){let r=Object.keys(e);if(!t||0===t.size){t=new Set(r);continue}for(let e of r){if(t.has(e))return!1;t.add(e)}}return!0};function ea(e){if(!("object"==typeof e&&null!==e)||"[object Object]"!==Object.prototype.toString.call(e))return!1;if(null===Object.getPrototypeOf(e))return!0;let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}var ei=[{hash:"SHA-256",name:"HMAC"},!0,["sign"]];function eo(e,t){if(e.algorithm.length!==parseInt(t.slice(1,4),10))throw TypeError(`Invalid key size for alg: ${t}`)}function es(e,t,r){if(o(e))return $(e,t,r),e;if(e instanceof Uint8Array)return i.subtle.importKey("raw",e,"AES-KW",!0,[r]);throw TypeError(z(e,...X,"Uint8Array"))}let ec=async(e,t,r)=>{let n=await es(t,e,"wrapKey");eo(n,e);let a=await i.subtle.importKey("raw",r,...ei);return new Uint8Array(await i.subtle.wrapKey("raw",a,n,"AES-KW"))},ed=async(e,t,r)=>{let n=await es(t,e,"unwrapKey");eo(n,e);let a=await i.subtle.unwrapKey("raw",r,n,"AES-KW",...ei);return new Uint8Array(await i.subtle.exportKey("raw",a))};async function eu(e,t,r,n,a=new Uint8Array(0),s=new Uint8Array(0)){let d;if(!o(e))throw TypeError(z(e,...X));if($(e,"ECDH"),!o(t))throw TypeError(z(t,...X));$(t,"ECDH","deriveBits");let l=u(y(c.encode(r)),y(a),y(s),h(n));d="X25519"===e.algorithm.name?256:"X448"===e.algorithm.name?448:Math.ceil(parseInt(e.algorithm.namedCurve.substr(-3),10)/8)<<3;let p=new Uint8Array(await i.subtle.deriveBits({name:e.algorithm.name,public:e},t,d));return f(p,n,l)}async function el(e){if(!o(e))throw TypeError(z(e,...X));return i.subtle.generateKey(e.algorithm,!0,["deriveBits"])}function ep(e){if(!o(e))throw TypeError(z(e,...X));return["P-256","P-384","P-521"].includes(e.algorithm.namedCurve)||"X25519"===e.algorithm.name||"X448"===e.algorithm.name}async function eh(e,t,r,n){!function(e){if(!(e instanceof Uint8Array)||e.length<8)throw new k("PBES2 Salt Input must be 8 or more octets")}(e);let a=u(c.encode(t),new Uint8Array([0]),e),s=parseInt(t.slice(13,16),10),d={hash:`SHA-${t.slice(8,11)}`,iterations:r,name:"PBKDF2",salt:a},l=await function(e,t){if(e instanceof Uint8Array)return i.subtle.importKey("raw",e,"PBKDF2",!1,["deriveBits"]);if(o(e))return $(e,t,"deriveBits","deriveKey"),e;throw TypeError(z(e,...X,"Uint8Array"))}(n,t);if(l.usages.includes("deriveBits"))return new Uint8Array(await i.subtle.deriveBits(d,l,s));if(l.usages.includes("deriveKey"))return i.subtle.deriveKey(d,l,{length:s,name:"AES-KW"},!1,["wrapKey","unwrapKey"]);throw TypeError('PBKDF2 key "usages" must include "deriveBits" or "deriveKey"')}let ey=async(e,t,r,n=2048,a=R(new Uint8Array(16)))=>{let i=await eh(a,e,n,t),o=await ec(e.slice(-6),i,r);return{encryptedKey:o,p2c:n,p2s:w(a)}},ef=async(e,t,r,n,a)=>{let i=await eh(a,e,n,t);return ed(e.slice(-6),i,r)};function em(e){switch(e){case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":return"RSA-OAEP";default:throw new _(`alg ${e} is not supported either by JOSE or your javascript runtime`)}}var ew=(e,t)=>{if(e.startsWith("RS")||e.startsWith("PS")){let{modulusLength:r}=t.algorithm;if("number"!=typeof r||r<2048)throw TypeError(`${e} requires key modulusLength to be 2048 bits or larger`)}};let eg=async(e,t,r)=>{if(!o(t))throw TypeError(z(t,...X));if($(t,e,"encrypt","wrapKey"),ew(e,t),t.usages.includes("encrypt"))return new Uint8Array(await i.subtle.encrypt(em(e),t,r));if(t.usages.includes("wrapKey")){let n=await i.subtle.importKey("raw",r,...ei);return new Uint8Array(await i.subtle.wrapKey("raw",n,t,em(e)))}throw TypeError('RSA-OAEP key "usages" must include "encrypt" or "wrapKey" for this operation')},eE=async(e,t,r)=>{if(!o(t))throw TypeError(z(t,...X));if($(t,e,"decrypt","unwrapKey"),ew(e,t),t.usages.includes("decrypt"))return new Uint8Array(await i.subtle.decrypt(em(e),t,r));if(t.usages.includes("unwrapKey")){let n=await i.subtle.unwrapKey("raw",r,t,em(e),...ei);return new Uint8Array(await i.subtle.exportKey("raw",n))}throw TypeError('RSA-OAEP key "usages" must include "decrypt" or "unwrapKey" for this operation')};function eA(e){switch(e){case"A128GCM":return 128;case"A192GCM":return 192;case"A256GCM":case"A128CBC-HS256":return 256;case"A192CBC-HS384":return 384;case"A256CBC-HS512":return 512;default:throw new _(`Unsupported JWE Algorithm: ${e}`)}}var ev=e=>R(new Uint8Array(eA(e)>>3)),eS=(e,t)=>{let r=(e.match(/.{1,64}/g)||[]).join("\n");return`-----BEGIN ${t}-----
${r}
-----END ${t}-----`};let eb=async(e,t,r)=>{if(!o(r))throw TypeError(z(r,...X));if(!r.extractable)throw TypeError("CryptoKey is not extractable");if(r.type!==e)throw TypeError(`key is not a ${e} key`);return eS(m(new Uint8Array(await i.subtle.exportKey(t,r))),`${e.toUpperCase()} KEY`)},e_=e=>eb("public","spki",e),eH=e=>eb("private","pkcs8",e),ek=(e,t,r=0)=>{0===r&&(t.unshift(t.length),t.unshift(6));let n=e.indexOf(t[0],r);if(-1===n)return!1;let a=e.subarray(n,n+t.length);return a.length===t.length&&(a.every((e,r)=>e===t[r])||ek(e,t,n+1))},eC=e=>{switch(!0){case ek(e,[42,134,72,206,61,3,1,7]):return"P-256";case ek(e,[43,129,4,0,34]):return"P-384";case ek(e,[43,129,4,0,35]):return"P-521";case ek(e,[43,101,110]):return"X25519";case ek(e,[43,101,111]):return"X448";case ek(e,[43,101,112]):return"Ed25519";case ek(e,[43,101,113]):return"Ed448";default:throw new _("Invalid or unsupported EC Key Curve or OKP Key Sub Type")}},eP=async(e,t,r,n,a)=>{var o,s;let c,d;let u=new Uint8Array(atob(r.replace(e,"")).split("").map(e=>e.charCodeAt(0))),l="spki"===t;switch(n){case"PS256":case"PS384":case"PS512":c={name:"RSA-PSS",hash:`SHA-${n.slice(-3)}`},d=l?["verify"]:["sign"];break;case"RS256":case"RS384":case"RS512":c={name:"RSASSA-PKCS1-v1_5",hash:`SHA-${n.slice(-3)}`},d=l?["verify"]:["sign"];break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":c={name:"RSA-OAEP",hash:`SHA-${parseInt(n.slice(-3),10)||1}`},d=l?["encrypt","wrapKey"]:["decrypt","unwrapKey"];break;case"ES256":c={name:"ECDSA",namedCurve:"P-256"},d=l?["verify"]:["sign"];break;case"ES384":c={name:"ECDSA",namedCurve:"P-384"},d=l?["verify"]:["sign"];break;case"ES512":c={name:"ECDSA",namedCurve:"P-521"},d=l?["verify"]:["sign"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{let e=eC(u);c=e.startsWith("P-")?{name:"ECDH",namedCurve:e}:{name:e},d=l?[]:["deriveBits"];break}case"EdDSA":c={name:eC(u)},d=l?["verify"]:["sign"];break;default:throw new _('Invalid or unsupported "alg" (Algorithm) value')}try{return await i.subtle.importKey(t,u,c,null!==(o=null==a?void 0:a.extractable)&&void 0!==o&&o,d)}catch(e){if("Ed25519"===c.name&&(null==e?void 0:e.name)==="NotSupportedError"&&j())return c={name:"NODE-ED25519",namedCurve:"NODE-ED25519"},await i.subtle.importKey(t,u,c,null!==(s=null==a?void 0:a.extractable)&&void 0!==s&&s,d);throw e}},eI=(e,t,r)=>eP(/(?:-----(?:BEGIN|END) PRIVATE KEY-----|\s)/g,"pkcs8",e,t,r),eK=(e,t,r)=>eP(/(?:-----(?:BEGIN|END) PUBLIC KEY-----|\s)/g,"spki",e,t,r);function eT(e){let t=[],r=0;for(;r<e.length;){let n=eW(e.subarray(r));t.push(n),r+=n.byteLength}return t}function eW(e){let t=0,r=31&e[0];if(t++,31===r){for(r=0;e[t]>=128;)r=128*r+e[t]-128,t++;r=128*r+e[t]-128,t++}let n=0;if(e[t]<128)n=e[t],t++;else if(128===n){for(n=0;0!==e[t+n]||0!==e[t+n+1];){if(n>e.byteLength)throw TypeError("invalid indefinite form length");n++}let r=t+n+2;return{byteLength:r,contents:e.subarray(t,t+n),raw:e.subarray(0,r)}}else{let r=127&e[t];t++,n=0;for(let a=0;a<r;a++)n=256*n+e[t],t++}let a=t+n;return{byteLength:a,contents:e.subarray(t,a),raw:e.subarray(0,a)}}let eJ=(e,t,r)=>{let n;try{n=function(e){let t=e.replace(/(?:-----(?:BEGIN|END) CERTIFICATE-----|\s)/g,""),r=g(t);return eS(function(e){let t=eT(eT(eW(e).contents)[0].contents);return m(t[160===t[0].raw[0]?6:5].raw)}(r),"PUBLIC KEY")}(e)}catch(e){throw TypeError("failed to parse the X.509 certificate",{cause:e})}return eK(n,t,r)},eD=async e=>{var t,r;if(!e.alg)throw TypeError('"alg" argument is required when "jwk.alg" is not present');let{algorithm:n,keyUsages:a}=function(e){let t,r;switch(e.kty){case"oct":switch(e.alg){case"HS256":case"HS384":case"HS512":t={name:"HMAC",hash:`SHA-${e.alg.slice(-3)}`},r=["sign","verify"];break;case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":throw new _(`${e.alg} keys cannot be imported as CryptoKey instances`);case"A128GCM":case"A192GCM":case"A256GCM":case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":t={name:"AES-GCM"},r=["encrypt","decrypt"];break;case"A128KW":case"A192KW":case"A256KW":t={name:"AES-KW"},r=["wrapKey","unwrapKey"];break;case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":t={name:"PBKDF2"},r=["deriveBits"];break;default:throw new _('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break;case"RSA":switch(e.alg){case"PS256":case"PS384":case"PS512":t={name:"RSA-PSS",hash:`SHA-${e.alg.slice(-3)}`},r=e.d?["sign"]:["verify"];break;case"RS256":case"RS384":case"RS512":t={name:"RSASSA-PKCS1-v1_5",hash:`SHA-${e.alg.slice(-3)}`},r=e.d?["sign"]:["verify"];break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":t={name:"RSA-OAEP",hash:`SHA-${parseInt(e.alg.slice(-3),10)||1}`},r=e.d?["decrypt","unwrapKey"]:["encrypt","wrapKey"];break;default:throw new _('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break;case"EC":switch(e.alg){case"ES256":t={name:"ECDSA",namedCurve:"P-256"},r=e.d?["sign"]:["verify"];break;case"ES384":t={name:"ECDSA",namedCurve:"P-384"},r=e.d?["sign"]:["verify"];break;case"ES512":t={name:"ECDSA",namedCurve:"P-521"},r=e.d?["sign"]:["verify"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":t={name:"ECDH",namedCurve:e.crv},r=e.d?["deriveBits"]:[];break;default:throw new _('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break;case"OKP":switch(e.alg){case"EdDSA":t={name:e.crv},r=e.d?["sign"]:["verify"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":t={name:e.crv},r=e.d?["deriveBits"]:[];break;default:throw new _('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break;default:throw new _('Invalid or unsupported JWK "kty" (Key Type) Parameter value')}return{algorithm:t,keyUsages:r}}(e),o=[n,null!==(t=e.ext)&&void 0!==t&&t,null!==(r=e.key_ops)&&void 0!==r?r:a];if("PBKDF2"===n.name)return i.subtle.importKey("raw",E(e.k),...o);let s={...e};delete s.alg,delete s.use;try{return await i.subtle.importKey("jwk",s,...o)}catch(e){if("Ed25519"===n.name&&(null==e?void 0:e.name)==="NotSupportedError"&&j())return o[0]={name:"NODE-ED25519",namedCurve:"NODE-ED25519"},await i.subtle.importKey("jwk",s,...o);throw e}};async function eR(e,t,r){if("string"!=typeof e||0!==e.indexOf("-----BEGIN PUBLIC KEY-----"))throw TypeError('"spki" must be SPKI formatted string');return eK(e,t,r)}async function ex(e,t,r){if("string"!=typeof e||0!==e.indexOf("-----BEGIN CERTIFICATE-----"))throw TypeError('"x509" must be X.509 formatted string');return eJ(e,t,r)}async function eO(e,t,r){if("string"!=typeof e||0!==e.indexOf("-----BEGIN PRIVATE KEY-----"))throw TypeError('"pkcs8" must be PKCS#8 formatted string');return eI(e,t,r)}async function eU(e,t,r){var n;if(!ea(e))throw TypeError("JWK must be an object");switch(t||(t=e.alg),e.kty){case"oct":if("string"!=typeof e.k||!e.k)throw TypeError('missing "k" (Key Value) Parameter value');if(null!=r||(r=!0!==e.ext),r)return eD({...e,alg:t,ext:null!==(n=e.ext)&&void 0!==n&&n});return E(e.k);case"RSA":if(void 0!==e.oth)throw new _('RSA JWK "oth" (Other Primes Info) Parameter value is not supported');case"EC":case"OKP":return eD({...e,alg:t});default:throw new _('Unsupported "kty" (Key Type) Parameter value')}}let eM=(e,t)=>{if(!(t instanceof Uint8Array)){if(!q(t))throw TypeError(V(e,t,...X,"Uint8Array"));if("secret"!==t.type)throw TypeError(`${X.join(" or ")} instances for symmetric algorithms must be of type "secret"`)}},eN=(e,t,r)=>{if(!q(t))throw TypeError(V(e,t,...X));if("secret"===t.type)throw TypeError(`${X.join(" or ")} instances for asymmetric algorithms must not be of type "secret"`);if("sign"===r&&"public"===t.type)throw TypeError(`${X.join(" or ")} instances for asymmetric algorithm signing must be of type "private"`);if("decrypt"===r&&"public"===t.type)throw TypeError(`${X.join(" or ")} instances for asymmetric algorithm decryption must be of type "private"`);if(t.algorithm&&"verify"===r&&"private"===t.type)throw TypeError(`${X.join(" or ")} instances for asymmetric algorithm verifying must be of type "public"`);if(t.algorithm&&"encrypt"===r&&"private"===t.type)throw TypeError(`${X.join(" or ")} instances for asymmetric algorithm encryption must be of type "public"`)},ej=(e,t,r)=>{let n=e.startsWith("HS")||"dir"===e||e.startsWith("PBES2")||/^A\d{3}(?:GCM)?KW$/.test(e);n?eM(e,t):eN(e,t,r)};async function eF(e,t,r,n,a){if(!(r instanceof Uint8Array))throw TypeError(z(r,"Uint8Array"));let o=parseInt(e.slice(1,4),10),s=await i.subtle.importKey("raw",r.subarray(o>>3),"AES-CBC",!1,["encrypt"]),c=await i.subtle.importKey("raw",r.subarray(0,o>>3),{hash:`SHA-${o<<1}`,name:"HMAC"},!1,["sign"]),d=new Uint8Array(await i.subtle.encrypt({iv:n,name:"AES-CBC"},s,t)),l=u(a,n,d,p(a.length<<3)),h=new Uint8Array((await i.subtle.sign("HMAC",c,l)).slice(0,o>>3));return{ciphertext:d,tag:h}}async function eB(e,t,r,n,a){let o;r instanceof Uint8Array?o=await i.subtle.importKey("raw",r,"AES-GCM",!1,["encrypt"]):($(r,e,"encrypt"),o=r);let s=new Uint8Array(await i.subtle.encrypt({additionalData:a,iv:n,name:"AES-GCM",tagLength:128},o,t)),c=s.slice(-16),d=s.slice(0,-16);return{ciphertext:d,tag:c}}let eG=async(e,t,r,n,a)=>{if(!o(r)&&!(r instanceof Uint8Array))throw TypeError(z(r,...X,"Uint8Array"));switch(U(e,n),e){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return r instanceof Uint8Array&&M(r,parseInt(e.slice(-3),10)),eF(e,t,r,n,a);case"A128GCM":case"A192GCM":case"A256GCM":return r instanceof Uint8Array&&M(r,parseInt(e.slice(1,4),10)),eB(e,t,r,n,a);default:throw new _("Unsupported JWE Content Encryption Algorithm")}};async function eL(e,t,r,n){let a=e.slice(0,7);n||(n=O(a));let{ciphertext:i,tag:o}=await eG(a,r,t,n,new Uint8Array(0));return{encryptedKey:i,iv:w(n),tag:w(o)}}async function e$(e,t,r,n,a){let i=e.slice(0,7);return ee(i,t,r,n,a,new Uint8Array(0))}async function eY(e,t,r,n,a){switch(ej(e,t,"decrypt"),e){case"dir":if(void 0!==r)throw new k("Encountered unexpected JWE Encrypted Key");return t;case"ECDH-ES":if(void 0!==r)throw new k("Encountered unexpected JWE Encrypted Key");case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{let a,i;if(!ea(n.epk))throw new k('JOSE Header "epk" (Ephemeral Public Key) missing or invalid');if(!ep(t))throw new _("ECDH with the provided key is not allowed or not supported by your javascript runtime");let o=await eU(n.epk,e);if(void 0!==n.apu){if("string"!=typeof n.apu)throw new k('JOSE Header "apu" (Agreement PartyUInfo) invalid');a=E(n.apu)}if(void 0!==n.apv){if("string"!=typeof n.apv)throw new k('JOSE Header "apv" (Agreement PartyVInfo) invalid');i=E(n.apv)}let s=await eu(o,t,"ECDH-ES"===e?n.enc:e,"ECDH-ES"===e?eA(n.enc):parseInt(e.slice(-5,-2),10),a,i);if("ECDH-ES"===e)return s;if(void 0===r)throw new k("JWE Encrypted Key missing");return ed(e.slice(-6),s,r)}case"RSA1_5":case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":if(void 0===r)throw new k("JWE Encrypted Key missing");return eE(e,t,r);case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{if(void 0===r)throw new k("JWE Encrypted Key missing");if("number"!=typeof n.p2c)throw new k('JOSE Header "p2c" (PBES2 Count) missing or invalid');let i=(null==a?void 0:a.maxPBES2Count)||1e4;if(n.p2c>i)throw new k('JOSE Header "p2c" (PBES2 Count) out is of acceptable bounds');if("string"!=typeof n.p2s)throw new k('JOSE Header "p2s" (PBES2 Salt) missing or invalid');return ef(e,t,r,n.p2c,E(n.p2s))}case"A128KW":case"A192KW":case"A256KW":if(void 0===r)throw new k("JWE Encrypted Key missing");return ed(e,t,r);case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":{if(void 0===r)throw new k("JWE Encrypted Key missing");if("string"!=typeof n.iv)throw new k('JOSE Header "iv" (Initialization Vector) missing or invalid');if("string"!=typeof n.tag)throw new k('JOSE Header "tag" (Authentication Tag) missing or invalid');let a=E(n.iv),i=E(n.tag);return e$(e,t,r,a,i)}default:throw new _('Invalid or unsupported "alg" (JWE Algorithm) header value')}}var ez=function(e,t,r,n,a){let i;if(void 0!==a.crit&&void 0===n.crit)throw new e('"crit" (Critical) Header Parameter MUST be integrity protected');if(!n||void 0===n.crit)return new Set;if(!Array.isArray(n.crit)||0===n.crit.length||n.crit.some(e=>"string"!=typeof e||0===e.length))throw new e('"crit" (Critical) Header Parameter MUST be an array of non-empty strings when present');for(let o of(i=void 0!==r?new Map([...Object.entries(r),...t.entries()]):t,n.crit)){if(!i.has(o))throw new _(`Extension Header Parameter "${o}" is not recognized`);if(void 0===a[o])throw new e(`Extension Header Parameter "${o}" is missing`);if(i.get(o)&&void 0===n[o])throw new e(`Extension Header Parameter "${o}" MUST be integrity protected`)}return new Set(n.crit)};let eV=(e,t)=>{if(void 0!==t&&(!Array.isArray(t)||t.some(e=>"string"!=typeof e)))throw TypeError(`"${e}" option must be an array of strings`);if(t)return new Set(t)};async function eq(e,t,r){var n;let a,i,o,s;if(!ea(e))throw new k("Flattened JWE must be an object");if(void 0===e.protected&&void 0===e.header&&void 0===e.unprotected)throw new k("JOSE Header missing");if("string"!=typeof e.iv)throw new k("JWE Initialization Vector missing or incorrect type");if("string"!=typeof e.ciphertext)throw new k("JWE Ciphertext missing or incorrect type");if("string"!=typeof e.tag)throw new k("JWE Authentication Tag missing or incorrect type");if(void 0!==e.protected&&"string"!=typeof e.protected)throw new k("JWE Protected Header incorrect type");if(void 0!==e.encrypted_key&&"string"!=typeof e.encrypted_key)throw new k("JWE Encrypted Key incorrect type");if(void 0!==e.aad&&"string"!=typeof e.aad)throw new k("JWE AAD incorrect type");if(void 0!==e.header&&!ea(e.header))throw new k("JWE Shared Unprotected Header incorrect type");if(void 0!==e.unprotected&&!ea(e.unprotected))throw new k("JWE Per-Recipient Unprotected Header incorrect type");if(e.protected)try{let t=E(e.protected);a=JSON.parse(d.decode(t))}catch(e){throw new k("JWE Protected Header is invalid")}if(!en(a,e.header,e.unprotected))throw new k("JWE Protected, JWE Unprotected Header, and JWE Per-Recipient Unprotected Header Parameter names must be disjoint");let l={...a,...e.header,...e.unprotected};if(ez(k,new Map,null==r?void 0:r.crit,a,l),void 0!==l.zip){if(!a||!a.zip)throw new k('JWE "zip" (Compression Algorithm) Header MUST be integrity protected');if("DEF"!==l.zip)throw new _('Unsupported JWE "zip" (Compression Algorithm) Header Parameter value')}let{alg:p,enc:h}=l;if("string"!=typeof p||!p)throw new k("missing JWE Algorithm (alg) in JWE Header");if("string"!=typeof h||!h)throw new k("missing JWE Encryption Algorithm (enc) in JWE Header");let y=r&&eV("keyManagementAlgorithms",r.keyManagementAlgorithms),f=r&&eV("contentEncryptionAlgorithms",r.contentEncryptionAlgorithms);if(y&&!y.has(p))throw new b('"alg" (Algorithm) Header Parameter not allowed');if(f&&!f.has(h))throw new b('"enc" (Encryption Algorithm) Header Parameter not allowed');void 0!==e.encrypted_key&&(i=E(e.encrypted_key));let m=!1;"function"==typeof t&&(t=await t(a,e),m=!0);try{o=await eY(p,t,i,l,r)}catch(e){if(e instanceof TypeError||e instanceof k||e instanceof _)throw e;o=ev(h)}let w=E(e.iv),g=E(e.tag),A=c.encode(null!==(n=e.protected)&&void 0!==n?n:"");s=void 0!==e.aad?u(A,c.encode("."),c.encode(e.aad)):A;let v=await ee(h,o,E(e.ciphertext),w,g,s);"DEF"===l.zip&&(v=await ((null==r?void 0:r.inflateRaw)||et)(v));let S={plaintext:v};return(void 0!==e.protected&&(S.protectedHeader=a),void 0!==e.aad&&(S.additionalAuthenticatedData=E(e.aad)),void 0!==e.unprotected&&(S.sharedUnprotectedHeader=e.unprotected),void 0!==e.header&&(S.unprotectedHeader=e.header),m)?{...S,key:t}:S}async function eX(e,t,r){if(e instanceof Uint8Array&&(e=d.decode(e)),"string"!=typeof e)throw new k("Compact JWE must be a string or Uint8Array");let{0:n,1:a,2:i,3:o,4:s,length:c}=e.split(".");if(5!==c)throw new k("Invalid Compact JWE");let u=await eq({ciphertext:o,iv:i||void 0,protected:n||void 0,tag:s||void 0,encrypted_key:a||void 0},t,r),l={plaintext:u.plaintext,protectedHeader:u.protectedHeader};return"function"==typeof t?{...l,key:u.key}:l}async function eZ(e,t,r){if(!ea(e))throw new k("General JWE must be an object");if(!Array.isArray(e.recipients)||!e.recipients.every(ea))throw new k("JWE Recipients missing or incorrect type");if(!e.recipients.length)throw new k("JWE Recipients has no members");for(let n of e.recipients)try{return await eq({aad:e.aad,ciphertext:e.ciphertext,encrypted_key:n.encrypted_key,header:n.header,iv:e.iv,protected:e.protected,tag:e.tag,unprotected:e.unprotected},t,r)}catch(e){}throw new H}let eQ=async e=>{if(e instanceof Uint8Array)return{kty:"oct",k:w(e)};if(!o(e))throw TypeError(z(e,...X,"Uint8Array"));if(!e.extractable)throw TypeError("non-extractable CryptoKey cannot be exported as a JWK");let{ext:t,key_ops:r,alg:n,use:a,...s}=await i.subtle.exportKey("jwk",e);return s};async function e0(e){return e_(e)}async function e2(e){return eH(e)}async function e1(e){return eQ(e)}async function e5(e,t,r,n,a={}){let i,o,s;switch(ej(e,r,"encrypt"),e){case"dir":s=r;break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{if(!ep(r))throw new _("ECDH with the provided key is not allowed or not supported by your javascript runtime");let{apu:c,apv:d}=a,{epk:u}=a;u||(u=(await el(r)).privateKey);let{x:l,y:p,crv:h,kty:y}=await e1(u),f=await eu(r,u,"ECDH-ES"===e?t:e,"ECDH-ES"===e?eA(t):parseInt(e.slice(-5,-2),10),c,d);if(o={epk:{x:l,crv:h,kty:y}},"EC"===y&&(o.epk.y=p),c&&(o.apu=w(c)),d&&(o.apv=w(d)),"ECDH-ES"===e){s=f;break}s=n||ev(t);let m=e.slice(-6);i=await ec(m,f,s);break}case"RSA1_5":case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":s=n||ev(t),i=await eg(e,r,s);break;case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{s=n||ev(t);let{p2c:c,p2s:d}=a;({encryptedKey:i,...o}=await ey(e,r,s,c,d));break}case"A128KW":case"A192KW":case"A256KW":s=n||ev(t),i=await ec(e,r,s);break;case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":{s=n||ev(t);let{iv:c}=a;({encryptedKey:i,...o}=await eL(e,r,s,c));break}default:throw new _('Invalid or unsupported "alg" (JWE Algorithm) header value')}return{cek:s,encryptedKey:i,parameters:o}}let e8=Symbol();class e6{constructor(e){if(!(e instanceof Uint8Array))throw TypeError("plaintext must be an instance of Uint8Array");this._plaintext=e}setKeyManagementParameters(e){if(this._keyManagementParameters)throw TypeError("setKeyManagementParameters can only be called once");return this._keyManagementParameters=e,this}setProtectedHeader(e){if(this._protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this._protectedHeader=e,this}setSharedUnprotectedHeader(e){if(this._sharedUnprotectedHeader)throw TypeError("setSharedUnprotectedHeader can only be called once");return this._sharedUnprotectedHeader=e,this}setUnprotectedHeader(e){if(this._unprotectedHeader)throw TypeError("setUnprotectedHeader can only be called once");return this._unprotectedHeader=e,this}setAdditionalAuthenticatedData(e){return this._aad=e,this}setContentEncryptionKey(e){if(this._cek)throw TypeError("setContentEncryptionKey can only be called once");return this._cek=e,this}setInitializationVector(e){if(this._iv)throw TypeError("setInitializationVector can only be called once");return this._iv=e,this}async encrypt(e,t){let r,n,a,i,o,s,l;if(!this._protectedHeader&&!this._unprotectedHeader&&!this._sharedUnprotectedHeader)throw new k("either setProtectedHeader, setUnprotectedHeader, or sharedUnprotectedHeader must be called before #encrypt()");if(!en(this._protectedHeader,this._unprotectedHeader,this._sharedUnprotectedHeader))throw new k("JWE Protected, JWE Shared Unprotected and JWE Per-Recipient Header Parameter names must be disjoint");let p={...this._protectedHeader,...this._unprotectedHeader,...this._sharedUnprotectedHeader};if(ez(k,new Map,null==t?void 0:t.crit,this._protectedHeader,p),void 0!==p.zip){if(!this._protectedHeader||!this._protectedHeader.zip)throw new k('JWE "zip" (Compression Algorithm) Header MUST be integrity protected');if("DEF"!==p.zip)throw new _('Unsupported JWE "zip" (Compression Algorithm) Header Parameter value')}let{alg:h,enc:y}=p;if("string"!=typeof h||!h)throw new k('JWE "alg" (Algorithm) Header Parameter missing or invalid');if("string"!=typeof y||!y)throw new k('JWE "enc" (Encryption Algorithm) Header Parameter missing or invalid');if("dir"===h){if(this._cek)throw TypeError("setContentEncryptionKey cannot be called when using Direct Encryption")}else if("ECDH-ES"===h&&this._cek)throw TypeError("setContentEncryptionKey cannot be called when using Direct Key Agreement");{let a;({cek:n,encryptedKey:r,parameters:a}=await e5(h,y,e,this._cek,this._keyManagementParameters)),a&&(t&&e8 in t?this._unprotectedHeader?this._unprotectedHeader={...this._unprotectedHeader,...a}:this.setUnprotectedHeader(a):this._protectedHeader?this._protectedHeader={...this._protectedHeader,...a}:this.setProtectedHeader(a))}if(this._iv||(this._iv=O(y)),i=this._protectedHeader?c.encode(w(JSON.stringify(this._protectedHeader))):c.encode(""),this._aad?(o=w(this._aad),a=u(i,c.encode("."),c.encode(o))):a=i,"DEF"===p.zip){let e=await ((null==t?void 0:t.deflateRaw)||er)(this._plaintext);({ciphertext:s,tag:l}=await eG(y,e,n,this._iv,a))}else({ciphertext:s,tag:l}=await eG(y,this._plaintext,n,this._iv,a));let f={ciphertext:w(s),iv:w(this._iv),tag:w(l)};return r&&(f.encrypted_key=w(r)),o&&(f.aad=o),this._protectedHeader&&(f.protected=d.decode(i)),this._sharedUnprotectedHeader&&(f.unprotected=this._sharedUnprotectedHeader),this._unprotectedHeader&&(f.header=this._unprotectedHeader),f}}class e4{constructor(e,t,r){this.parent=e,this.key=t,this.options=r}setUnprotectedHeader(e){if(this.unprotectedHeader)throw TypeError("setUnprotectedHeader can only be called once");return this.unprotectedHeader=e,this}addRecipient(...e){return this.parent.addRecipient(...e)}encrypt(...e){return this.parent.encrypt(...e)}done(){return this.parent}}class e3{constructor(e){this._recipients=[],this._plaintext=e}addRecipient(e,t){let r=new e4(this,e,{crit:null==t?void 0:t.crit});return this._recipients.push(r),r}setProtectedHeader(e){if(this._protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this._protectedHeader=e,this}setSharedUnprotectedHeader(e){if(this._unprotectedHeader)throw TypeError("setSharedUnprotectedHeader can only be called once");return this._unprotectedHeader=e,this}setAdditionalAuthenticatedData(e){return this._aad=e,this}async encrypt(e){var t,r,n;let a;if(!this._recipients.length)throw new k("at least one recipient must be added");if(e={deflateRaw:null==e?void 0:e.deflateRaw},1===this._recipients.length){let[t]=this._recipients,r=await new e6(this._plaintext).setAdditionalAuthenticatedData(this._aad).setProtectedHeader(this._protectedHeader).setSharedUnprotectedHeader(this._unprotectedHeader).setUnprotectedHeader(t.unprotectedHeader).encrypt(t.key,{...t.options,...e}),n={ciphertext:r.ciphertext,iv:r.iv,recipients:[{}],tag:r.tag};return r.aad&&(n.aad=r.aad),r.protected&&(n.protected=r.protected),r.unprotected&&(n.unprotected=r.unprotected),r.encrypted_key&&(n.recipients[0].encrypted_key=r.encrypted_key),r.header&&(n.recipients[0].header=r.header),n}for(let e=0;e<this._recipients.length;e++){let t=this._recipients[e];if(!en(this._protectedHeader,this._unprotectedHeader,t.unprotectedHeader))throw new k("JWE Protected, JWE Shared Unprotected and JWE Per-Recipient Header Parameter names must be disjoint");let r={...this._protectedHeader,...this._unprotectedHeader,...t.unprotectedHeader},{alg:n}=r;if("string"!=typeof n||!n)throw new k('JWE "alg" (Algorithm) Header Parameter missing or invalid');if("dir"===n||"ECDH-ES"===n)throw new k('"dir" and "ECDH-ES" alg may only be used with a single recipient');if("string"!=typeof r.enc||!r.enc)throw new k('JWE "enc" (Encryption Algorithm) Header Parameter missing or invalid');if(a){if(a!==r.enc)throw new k('JWE "enc" (Encryption Algorithm) Header Parameter must be the same for all recipients')}else a=r.enc;if(ez(k,new Map,t.options.crit,this._protectedHeader,r),void 0!==r.zip&&(!this._protectedHeader||!this._protectedHeader.zip))throw new k('JWE "zip" (Compression Algorithm) Header MUST be integrity protected')}let i=ev(a),o={ciphertext:"",iv:"",recipients:[],tag:""};for(let s=0;s<this._recipients.length;s++){let c=this._recipients[s],d={};o.recipients.push(d);let u={...this._protectedHeader,...this._unprotectedHeader,...c.unprotectedHeader},l=u.alg.startsWith("PBES2")?2048+s:void 0;if(0===s){let t=await new e6(this._plaintext).setAdditionalAuthenticatedData(this._aad).setContentEncryptionKey(i).setProtectedHeader(this._protectedHeader).setSharedUnprotectedHeader(this._unprotectedHeader).setUnprotectedHeader(c.unprotectedHeader).setKeyManagementParameters({p2c:l}).encrypt(c.key,{...c.options,...e,[e8]:!0});o.ciphertext=t.ciphertext,o.iv=t.iv,o.tag=t.tag,t.aad&&(o.aad=t.aad),t.protected&&(o.protected=t.protected),t.unprotected&&(o.unprotected=t.unprotected),d.encrypted_key=t.encrypted_key,t.header&&(d.header=t.header);continue}let{encryptedKey:p,parameters:h}=await e5((null===(t=c.unprotectedHeader)||void 0===t?void 0:t.alg)||(null===(r=this._protectedHeader)||void 0===r?void 0:r.alg)||(null===(n=this._unprotectedHeader)||void 0===n?void 0:n.alg),a,c.key,i,{p2c:l});d.encrypted_key=w(p),(c.unprotectedHeader||h)&&(d.header={...c.unprotectedHeader,...h})}return o}}function e9(e,t){let r=`SHA-${e.slice(-3)}`;switch(e){case"HS256":case"HS384":case"HS512":return{hash:r,name:"HMAC"};case"PS256":case"PS384":case"PS512":return{hash:r,name:"RSA-PSS",saltLength:e.slice(-3)>>3};case"RS256":case"RS384":case"RS512":return{hash:r,name:"RSASSA-PKCS1-v1_5"};case"ES256":case"ES384":case"ES512":return{hash:r,name:"ECDSA",namedCurve:t.namedCurve};case"EdDSA":if(j()&&"NODE-ED25519"===t.name)return{name:"NODE-ED25519",namedCurve:"NODE-ED25519"};return{name:t.name};default:throw new _(`alg ${e} is not supported either by JOSE or your javascript runtime`)}}function e7(e,t,r){if(o(t))return!function(e,t,...r){switch(t){case"HS256":case"HS384":case"HS512":{if(!B(e.algorithm,"HMAC"))throw F("HMAC");let r=parseInt(t.slice(2),10),n=G(e.algorithm.hash);if(n!==r)throw F(`SHA-${r}`,"algorithm.hash");break}case"RS256":case"RS384":case"RS512":{if(!B(e.algorithm,"RSASSA-PKCS1-v1_5"))throw F("RSASSA-PKCS1-v1_5");let r=parseInt(t.slice(2),10),n=G(e.algorithm.hash);if(n!==r)throw F(`SHA-${r}`,"algorithm.hash");break}case"PS256":case"PS384":case"PS512":{if(!B(e.algorithm,"RSA-PSS"))throw F("RSA-PSS");let r=parseInt(t.slice(2),10),n=G(e.algorithm.hash);if(n!==r)throw F(`SHA-${r}`,"algorithm.hash");break}case"EdDSA":if("Ed25519"!==e.algorithm.name&&"Ed448"!==e.algorithm.name){if(j()){if(B(e.algorithm,"NODE-ED25519"))break;throw F("Ed25519, Ed448, or NODE-ED25519")}throw F("Ed25519 or Ed448")}break;case"ES256":case"ES384":case"ES512":{if(!B(e.algorithm,"ECDSA"))throw F("ECDSA");let r=function(e){switch(e){case"ES256":return"P-256";case"ES384":return"P-384";case"ES512":return"P-521";default:throw Error("unreachable")}}(t),n=e.algorithm.namedCurve;if(n!==r)throw F(r,"algorithm.namedCurve");break}default:throw TypeError("CryptoKey does not support this operation")}L(e,r)}(t,e,r),t;if(t instanceof Uint8Array){if(!e.startsWith("HS"))throw TypeError(z(t,...X));return i.subtle.importKey("raw",t,{hash:`SHA-${e.slice(-3)}`,name:"HMAC"},!1,[r])}throw TypeError(z(t,...X,"Uint8Array"))}let te=async(e,t,r,n)=>{let a=await e7(e,t,"verify");ew(e,a);let o=e9(e,a.algorithm);try{return await i.subtle.verify(o,a,r,n)}catch(e){return!1}};async function tt(e,t,r){var n;let a;if(!ea(e))throw new C("Flattened JWS must be an object");if(void 0===e.protected&&void 0===e.header)throw new C('Flattened JWS must have either of the "protected" or "header" members');if(void 0!==e.protected&&"string"!=typeof e.protected)throw new C("JWS Protected Header incorrect type");if(void 0===e.payload)throw new C("JWS Payload missing");if("string"!=typeof e.signature)throw new C("JWS Signature missing or incorrect type");if(void 0!==e.header&&!ea(e.header))throw new C("JWS Unprotected Header incorrect type");let i={};if(e.protected)try{let t=E(e.protected);i=JSON.parse(d.decode(t))}catch(e){throw new C("JWS Protected Header is invalid")}if(!en(i,e.header))throw new C("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");let o={...i,...e.header},s=ez(C,new Map([["b64",!0]]),null==r?void 0:r.crit,i,o),l=!0;if(s.has("b64")&&"boolean"!=typeof(l=i.b64))throw new C('The "b64" (base64url-encode payload) Header Parameter must be a boolean');let{alg:p}=o;if("string"!=typeof p||!p)throw new C('JWS "alg" (Algorithm) Header Parameter missing or invalid');let h=r&&eV("algorithms",r.algorithms);if(h&&!h.has(p))throw new b('"alg" (Algorithm) Header Parameter not allowed');if(l){if("string"!=typeof e.payload)throw new C("JWS Payload must be a string")}else if("string"!=typeof e.payload&&!(e.payload instanceof Uint8Array))throw new C("JWS Payload must be a string or an Uint8Array instance");let y=!1;"function"==typeof t&&(t=await t(i,e),y=!0),ej(p,t,"verify");let f=u(c.encode(null!==(n=e.protected)&&void 0!==n?n:""),c.encode("."),"string"==typeof e.payload?c.encode(e.payload):e.payload),m=E(e.signature),w=await te(p,t,m,f);if(!w)throw new D;a=l?E(e.payload):"string"==typeof e.payload?c.encode(e.payload):e.payload;let g={payload:a};return(void 0!==e.protected&&(g.protectedHeader=i),void 0!==e.header&&(g.unprotectedHeader=e.header),y)?{...g,key:t}:g}async function tr(e,t,r){if(e instanceof Uint8Array&&(e=d.decode(e)),"string"!=typeof e)throw new C("Compact JWS must be a string or Uint8Array");let{0:n,1:a,2:i,length:o}=e.split(".");if(3!==o)throw new C("Invalid Compact JWS");let s=await tt({payload:a,protected:n,signature:i},t,r),c={payload:s.payload,protectedHeader:s.protectedHeader};return"function"==typeof t?{...c,key:s.key}:c}async function tn(e,t,r){if(!ea(e))throw new C("General JWS must be an object");if(!Array.isArray(e.signatures)||!e.signatures.every(ea))throw new C("JWS Signatures missing or incorrect type");for(let n of e.signatures)try{return await tt({header:n.header,payload:e.payload,protected:n.protected,signature:n.signature},t,r)}catch(e){}throw new D}var ta=e=>Math.floor(e.getTime()/1e3);let ti=604800,to=31557600,ts=/^(\d+|\d+\.\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)$/i;var tc=e=>{let t=ts.exec(e);if(!t)throw TypeError("Invalid time period format");let r=parseFloat(t[1]),n=t[2].toLowerCase();switch(n){case"sec":case"secs":case"second":case"seconds":case"s":return Math.round(r);case"minute":case"minutes":case"min":case"mins":case"m":return Math.round(60*r);case"hour":case"hours":case"hr":case"hrs":case"h":return Math.round(3600*r);case"day":case"days":case"d":return Math.round(86400*r);case"week":case"weeks":case"w":return Math.round(r*ti);default:return Math.round(r*to)}};let td=e=>e.toLowerCase().replace(/^application\//,""),tu=(e,t)=>"string"==typeof e?t.includes(e):!!Array.isArray(e)&&t.some(Set.prototype.has.bind(new Set(e)));var tl=(e,t,r={})=>{let n,a;let{typ:i}=r;if(i&&("string"!=typeof e.typ||td(e.typ)!==td(i)))throw new v('unexpected "typ" JWT header value',"typ","check_failed");try{n=JSON.parse(d.decode(t))}catch(e){}if(!ea(n))throw new P("JWT Claims Set must be a top-level JSON object");let{issuer:o}=r;if(o&&!(Array.isArray(o)?o:[o]).includes(n.iss))throw new v('unexpected "iss" claim value',"iss","check_failed");let{subject:s}=r;if(s&&n.sub!==s)throw new v('unexpected "sub" claim value',"sub","check_failed");let{audience:c}=r;if(c&&!tu(n.aud,"string"==typeof c?[c]:c))throw new v('unexpected "aud" claim value',"aud","check_failed");switch(typeof r.clockTolerance){case"string":a=tc(r.clockTolerance);break;case"number":a=r.clockTolerance;break;case"undefined":a=0;break;default:throw TypeError("Invalid clockTolerance option type")}let{currentDate:u}=r,l=ta(u||new Date);if((void 0!==n.iat||r.maxTokenAge)&&"number"!=typeof n.iat)throw new v('"iat" claim must be a number',"iat","invalid");if(void 0!==n.nbf){if("number"!=typeof n.nbf)throw new v('"nbf" claim must be a number',"nbf","invalid");if(n.nbf>l+a)throw new v('"nbf" claim timestamp check failed',"nbf","check_failed")}if(void 0!==n.exp){if("number"!=typeof n.exp)throw new v('"exp" claim must be a number',"exp","invalid");if(n.exp<=l-a)throw new S('"exp" claim timestamp check failed',"exp","check_failed")}if(r.maxTokenAge){let e=l-n.iat,t="number"==typeof r.maxTokenAge?r.maxTokenAge:tc(r.maxTokenAge);if(e-a>t)throw new S('"iat" claim timestamp check failed (too far in the past)',"iat","check_failed");if(e<0-a)throw new v('"iat" claim timestamp check failed (it should be in the past)',"iat","check_failed")}return n};async function tp(e,t,r){var n;let a=await tr(e,t,r);if((null===(n=a.protectedHeader.crit)||void 0===n?void 0:n.includes("b64"))&&!1===a.protectedHeader.b64)throw new P("JWTs MUST NOT use unencoded payload");let i=tl(a.protectedHeader,a.payload,r),o={payload:i,protectedHeader:a.protectedHeader};return"function"==typeof t?{...o,key:a.key}:o}async function th(e,t,r){let n=await eX(e,t,r),a=tl(n.protectedHeader,n.plaintext,r),{protectedHeader:i}=n;if(void 0!==i.iss&&i.iss!==a.iss)throw new v('replicated "iss" claim header parameter mismatch',"iss","mismatch");if(void 0!==i.sub&&i.sub!==a.sub)throw new v('replicated "sub" claim header parameter mismatch',"sub","mismatch");if(void 0!==i.aud&&JSON.stringify(i.aud)!==JSON.stringify(a.aud))throw new v('replicated "aud" claim header parameter mismatch',"aud","mismatch");let o={payload:a,protectedHeader:i};return"function"==typeof t?{...o,key:n.key}:o}class ty{constructor(e){this._flattened=new e6(e)}setContentEncryptionKey(e){return this._flattened.setContentEncryptionKey(e),this}setInitializationVector(e){return this._flattened.setInitializationVector(e),this}setProtectedHeader(e){return this._flattened.setProtectedHeader(e),this}setKeyManagementParameters(e){return this._flattened.setKeyManagementParameters(e),this}async encrypt(e,t){let r=await this._flattened.encrypt(e,t);return[r.protected,r.encrypted_key,r.iv,r.ciphertext,r.tag].join(".")}}let tf=async(e,t,r)=>{let n=await e7(e,t,"sign");ew(e,n);let a=await i.subtle.sign(e9(e,n.algorithm),n,r);return new Uint8Array(a)};class tm{constructor(e){if(!(e instanceof Uint8Array))throw TypeError("payload must be an instance of Uint8Array");this._payload=e}setProtectedHeader(e){if(this._protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this._protectedHeader=e,this}setUnprotectedHeader(e){if(this._unprotectedHeader)throw TypeError("setUnprotectedHeader can only be called once");return this._unprotectedHeader=e,this}async sign(e,t){let r;if(!this._protectedHeader&&!this._unprotectedHeader)throw new C("either setProtectedHeader or setUnprotectedHeader must be called before #sign()");if(!en(this._protectedHeader,this._unprotectedHeader))throw new C("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");let n={...this._protectedHeader,...this._unprotectedHeader},a=ez(C,new Map([["b64",!0]]),null==t?void 0:t.crit,this._protectedHeader,n),i=!0;if(a.has("b64")&&"boolean"!=typeof(i=this._protectedHeader.b64))throw new C('The "b64" (base64url-encode payload) Header Parameter must be a boolean');let{alg:o}=n;if("string"!=typeof o||!o)throw new C('JWS "alg" (Algorithm) Header Parameter missing or invalid');ej(o,e,"sign");let s=this._payload;i&&(s=c.encode(w(s))),r=this._protectedHeader?c.encode(w(JSON.stringify(this._protectedHeader))):c.encode("");let l=u(r,c.encode("."),s),p=await tf(o,e,l),h={signature:w(p),payload:""};return i&&(h.payload=d.decode(s)),this._unprotectedHeader&&(h.header=this._unprotectedHeader),this._protectedHeader&&(h.protected=d.decode(r)),h}}class tw{constructor(e){this._flattened=new tm(e)}setProtectedHeader(e){return this._flattened.setProtectedHeader(e),this}async sign(e,t){let r=await this._flattened.sign(e,t);if(void 0===r.payload)throw TypeError("use the flattened module for creating JWS with b64: false");return`${r.protected}.${r.payload}.${r.signature}`}}class tg{constructor(e,t,r){this.parent=e,this.key=t,this.options=r}setProtectedHeader(e){if(this.protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this.protectedHeader=e,this}setUnprotectedHeader(e){if(this.unprotectedHeader)throw TypeError("setUnprotectedHeader can only be called once");return this.unprotectedHeader=e,this}addSignature(...e){return this.parent.addSignature(...e)}sign(...e){return this.parent.sign(...e)}done(){return this.parent}}class tE{constructor(e){this._signatures=[],this._payload=e}addSignature(e,t){let r=new tg(this,e,t);return this._signatures.push(r),r}async sign(){if(!this._signatures.length)throw new C("at least one signature must be added");let e={signatures:[],payload:""};for(let t=0;t<this._signatures.length;t++){let r=this._signatures[t],n=new tm(this._payload);n.setProtectedHeader(r.protectedHeader),n.setUnprotectedHeader(r.unprotectedHeader);let{payload:a,...i}=await n.sign(r.key,r.options);if(0===t)e.payload=a;else if(e.payload!==a)throw new C("inconsistent use of JWS Unencoded Payload Option (RFC7797)");e.signatures.push(i)}return e}}class tA{constructor(e){if(!ea(e))throw TypeError("JWT Claims Set MUST be an object");this._payload=e}setIssuer(e){return this._payload={...this._payload,iss:e},this}setSubject(e){return this._payload={...this._payload,sub:e},this}setAudience(e){return this._payload={...this._payload,aud:e},this}setJti(e){return this._payload={...this._payload,jti:e},this}setNotBefore(e){return"number"==typeof e?this._payload={...this._payload,nbf:e}:this._payload={...this._payload,nbf:ta(new Date)+tc(e)},this}setExpirationTime(e){return"number"==typeof e?this._payload={...this._payload,exp:e}:this._payload={...this._payload,exp:ta(new Date)+tc(e)},this}setIssuedAt(e){return void 0===e?this._payload={...this._payload,iat:ta(new Date)}:this._payload={...this._payload,iat:e},this}}class tv extends tA{setProtectedHeader(e){return this._protectedHeader=e,this}async sign(e,t){var r;let n=new tw(c.encode(JSON.stringify(this._payload)));if(n.setProtectedHeader(this._protectedHeader),Array.isArray(null===(r=this._protectedHeader)||void 0===r?void 0:r.crit)&&this._protectedHeader.crit.includes("b64")&&!1===this._protectedHeader.b64)throw new P("JWTs MUST NOT use unencoded payload");return n.sign(e,t)}}class tS extends tA{setProtectedHeader(e){if(this._protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this._protectedHeader=e,this}setKeyManagementParameters(e){if(this._keyManagementParameters)throw TypeError("setKeyManagementParameters can only be called once");return this._keyManagementParameters=e,this}setContentEncryptionKey(e){if(this._cek)throw TypeError("setContentEncryptionKey can only be called once");return this._cek=e,this}setInitializationVector(e){if(this._iv)throw TypeError("setInitializationVector can only be called once");return this._iv=e,this}replicateIssuerAsHeader(){return this._replicateIssuerAsHeader=!0,this}replicateSubjectAsHeader(){return this._replicateSubjectAsHeader=!0,this}replicateAudienceAsHeader(){return this._replicateAudienceAsHeader=!0,this}async encrypt(e,t){let r=new ty(c.encode(JSON.stringify(this._payload)));return this._replicateIssuerAsHeader&&(this._protectedHeader={...this._protectedHeader,iss:this._payload.iss}),this._replicateSubjectAsHeader&&(this._protectedHeader={...this._protectedHeader,sub:this._payload.sub}),this._replicateAudienceAsHeader&&(this._protectedHeader={...this._protectedHeader,aud:this._payload.aud}),r.setProtectedHeader(this._protectedHeader),this._iv&&r.setInitializationVector(this._iv),this._cek&&r.setContentEncryptionKey(this._cek),this._keyManagementParameters&&r.setKeyManagementParameters(this._keyManagementParameters),r.encrypt(e,t)}}let tb=(e,t)=>{if("string"!=typeof e||!e)throw new I(`${t} missing or invalid`)};async function t_(e,t){let r;if(!ea(e))throw TypeError("JWK must be an object");if(null!=t||(t="sha256"),"sha256"!==t&&"sha384"!==t&&"sha512"!==t)throw TypeError('digestAlgorithm must one of "sha256", "sha384", or "sha512"');switch(e.kty){case"EC":tb(e.crv,'"crv" (Curve) Parameter'),tb(e.x,'"x" (X Coordinate) Parameter'),tb(e.y,'"y" (Y Coordinate) Parameter'),r={crv:e.crv,kty:e.kty,x:e.x,y:e.y};break;case"OKP":tb(e.crv,'"crv" (Subtype of Key Pair) Parameter'),tb(e.x,'"x" (Public Key) Parameter'),r={crv:e.crv,kty:e.kty,x:e.x};break;case"RSA":tb(e.e,'"e" (Exponent) Parameter'),tb(e.n,'"n" (Modulus) Parameter'),r={e:e.e,kty:e.kty,n:e.n};break;case"oct":tb(e.k,'"k" (Key Value) Parameter'),r={k:e.k,kty:e.kty};break;default:throw new _('"kty" (Key Type) Parameter missing or unsupported')}let n=c.encode(JSON.stringify(r));return w(await s(t,n))}async function tH(e,t){null!=t||(t="sha256");let r=await t_(e,t);return`urn:ietf:params:oauth:jwk-thumbprint:sha-${t.slice(-3)}:${r}`}async function tk(e,t){let r={...e,...null==t?void 0:t.header};if(!ea(r.jwk))throw new C('"jwk" (JSON Web Key) Header Parameter must be a JSON object');let n=await eU({...r.jwk,ext:!0},r.alg,!0);if(n instanceof Uint8Array||"public"!==n.type)throw new C('"jwk" (JSON Web Key) Header Parameter must be a public key');return n}function tC(e){return e&&"object"==typeof e&&Array.isArray(e.keys)&&e.keys.every(tP)}function tP(e){return ea(e)}class tI{constructor(e){if(this._cached=new WeakMap,!tC(e))throw new K("JSON Web Key Set malformed");this._jwks="function"==typeof structuredClone?structuredClone(e):JSON.parse(JSON.stringify(e))}async getKey(e,t){let{alg:r,kid:n}={...e,...null==t?void 0:t.header},a=function(e){switch("string"==typeof e&&e.slice(0,2)){case"RS":case"PS":return"RSA";case"ES":return"EC";case"Ed":return"OKP";default:throw new _('Unsupported "alg" value for a JSON Web Key Set')}}(r),i=this._jwks.keys.filter(e=>{let t=a===e.kty;if(t&&"string"==typeof n&&(t=n===e.kid),t&&"string"==typeof e.alg&&(t=r===e.alg),t&&"string"==typeof e.use&&(t="sig"===e.use),t&&Array.isArray(e.key_ops)&&(t=e.key_ops.includes("verify")),t&&"EdDSA"===r&&(t="Ed25519"===e.crv||"Ed448"===e.crv),t)switch(r){case"ES256":t="P-256"===e.crv;break;case"ES256K":t="secp256k1"===e.crv;break;case"ES384":t="P-384"===e.crv;break;case"ES512":t="P-521"===e.crv}return t}),{0:o,length:s}=i;if(0===s)throw new T;if(1!==s){let e=new W,{_cached:t}=this;throw e[Symbol.asyncIterator]=async function*(){for(let e of i)try{yield await tK(t,e,r)}catch(e){continue}},e}return tK(this._cached,o,r)}}async function tK(e,t,r){let n=e.get(t)||e.set(t,{}).get(t);if(void 0===n[r]){let e=await eU({...t,ext:!0},r);if(e instanceof Uint8Array||"public"!==e.type)throw new K("JSON Web Key Set members must be public keys");n[r]=e}return n[r]}function tT(e){let t=new tI(e);return async function(e,r){return t.getKey(e,r)}}let tW=async(e,t,r)=>{let n,a;let i=!1;"function"==typeof AbortController&&(n=new AbortController,a=setTimeout(()=>{i=!0,n.abort()},t));let o=await fetch(e.href,{signal:n?n.signal:void 0,redirect:"manual",headers:r.headers}).catch(e=>{if(i)throw new J;throw e});if(void 0!==a&&clearTimeout(a),200!==o.status)throw new A("Expected 200 OK from the JSON Web Key Set HTTP response");try{return await o.json()}catch(e){throw new A("Failed to parse the JSON Web Key Set HTTP response as JSON")}};class tJ extends tI{constructor(e,t){if(super({keys:[]}),this._jwks=void 0,!(e instanceof URL))throw TypeError("url must be an instance of URL");this._url=new URL(e.href),this._options={agent:null==t?void 0:t.agent,headers:null==t?void 0:t.headers},this._timeoutDuration="number"==typeof(null==t?void 0:t.timeoutDuration)?null==t?void 0:t.timeoutDuration:5e3,this._cooldownDuration="number"==typeof(null==t?void 0:t.cooldownDuration)?null==t?void 0:t.cooldownDuration:3e4,this._cacheMaxAge="number"==typeof(null==t?void 0:t.cacheMaxAge)?null==t?void 0:t.cacheMaxAge:6e5}coolingDown(){return"number"==typeof this._jwksTimestamp&&Date.now()<this._jwksTimestamp+this._cooldownDuration}fresh(){return"number"==typeof this._jwksTimestamp&&Date.now()<this._jwksTimestamp+this._cacheMaxAge}async getKey(e,t){this._jwks&&this.fresh()||await this.reload();try{return await super.getKey(e,t)}catch(r){if(r instanceof T&&!1===this.coolingDown())return await this.reload(),super.getKey(e,t);throw r}}async reload(){this._pendingFetch&&j()&&(this._pendingFetch=void 0),this._pendingFetch||(this._pendingFetch=tW(this._url,this._timeoutDuration,this._options).then(e=>{if(!tC(e))throw new K("JSON Web Key Set malformed");this._jwks={keys:e.keys},this._jwksTimestamp=Date.now(),this._pendingFetch=void 0}).catch(e=>{throw this._pendingFetch=void 0,e})),await this._pendingFetch}}function tD(e,t){let r=new tJ(e,t);return async function(e,t){return r.getKey(e,t)}}class tR extends tA{encode(){let e=w(JSON.stringify({alg:"none"})),t=w(JSON.stringify(this._payload));return`${e}.${t}.`}static decode(e,t){let r;if("string"!=typeof e)throw new P("Unsecured JWT must be a string");let{0:n,1:a,2:i,length:o}=e.split(".");if(3!==o||""!==i)throw new P("Invalid Unsecured JWT");try{if(r=JSON.parse(d.decode(E(n))),"none"!==r.alg)throw Error()}catch(e){throw new P("Invalid Unsecured JWT")}let s=tl(r,E(a),t);return{payload:s,header:r}}}let tx=w,tO=E;function tU(e){let t;if("string"==typeof e){let r=e.split(".");(3===r.length||5===r.length)&&([t]=r)}else if("object"==typeof e&&e){if("protected"in e)t=e.protected;else throw TypeError("Token does not contain a Protected Header")}try{if("string"!=typeof t||!t)throw Error();let e=JSON.parse(d.decode(tO(t)));if(!ea(e))throw Error();return e}catch(e){throw TypeError("Invalid Token or Protected Header formatting")}}function tM(e){let t,r;if("string"!=typeof e)throw new P("JWTs must use Compact JWS serialization, JWT must be a string");let{1:n,length:a}=e.split(".");if(5===a)throw new P("Only JWTs using Compact JWS serialization can be decoded");if(3!==a)throw new P("Invalid JWT");if(!n)throw new P("JWTs must contain a payload");try{t=tO(n)}catch(e){throw new P("Failed to parse the base64url encoded payload")}try{r=JSON.parse(d.decode(t))}catch(e){throw new P("Failed to parse the decoded payload as JSON")}if(!ea(r))throw new P("Invalid JWT Claims Set");return r}async function tN(e,t){var r;let n,a,o;switch(e){case"HS256":case"HS384":case"HS512":a={name:"HMAC",hash:`SHA-${n=parseInt(e.slice(-3),10)}`,length:n},o=["sign","verify"];break;case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return n=parseInt(e.slice(-3),10),R(new Uint8Array(n>>3));case"A128KW":case"A192KW":case"A256KW":a={name:"AES-KW",length:n=parseInt(e.slice(1,4),10)},o=["wrapKey","unwrapKey"];break;case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":case"A128GCM":case"A192GCM":case"A256GCM":a={name:"AES-GCM",length:n=parseInt(e.slice(1,4),10)},o=["encrypt","decrypt"];break;default:throw new _('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}return i.subtle.generateKey(a,null!==(r=null==t?void 0:t.extractable)&&void 0!==r&&r,o)}function tj(e){var t;let r=null!==(t=null==e?void 0:e.modulusLength)&&void 0!==t?t:2048;if("number"!=typeof r||r<2048)throw new _("Invalid or unsupported modulusLength option provided, 2048 bits or larger keys must be used");return r}async function tF(e,t){var r,n,a,o;let s,c;switch(e){case"PS256":case"PS384":case"PS512":s={name:"RSA-PSS",hash:`SHA-${e.slice(-3)}`,publicExponent:new Uint8Array([1,0,1]),modulusLength:tj(t)},c=["sign","verify"];break;case"RS256":case"RS384":case"RS512":s={name:"RSASSA-PKCS1-v1_5",hash:`SHA-${e.slice(-3)}`,publicExponent:new Uint8Array([1,0,1]),modulusLength:tj(t)},c=["sign","verify"];break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":s={name:"RSA-OAEP",hash:`SHA-${parseInt(e.slice(-3),10)||1}`,publicExponent:new Uint8Array([1,0,1]),modulusLength:tj(t)},c=["decrypt","unwrapKey","encrypt","wrapKey"];break;case"ES256":s={name:"ECDSA",namedCurve:"P-256"},c=["sign","verify"];break;case"ES384":s={name:"ECDSA",namedCurve:"P-384"},c=["sign","verify"];break;case"ES512":s={name:"ECDSA",namedCurve:"P-521"},c=["sign","verify"];break;case"EdDSA":c=["sign","verify"];let d=null!==(r=null==t?void 0:t.crv)&&void 0!==r?r:"Ed25519";switch(d){case"Ed25519":case"Ed448":s={name:d};break;default:throw new _("Invalid or unsupported crv option provided")}break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{c=["deriveKey","deriveBits"];let e=null!==(n=null==t?void 0:t.crv)&&void 0!==n?n:"P-256";switch(e){case"P-256":case"P-384":case"P-521":s={name:"ECDH",namedCurve:e};break;case"X25519":case"X448":s={name:e};break;default:throw new _("Invalid or unsupported crv option provided, supported values are P-256, P-384, P-521, X25519, and X448")}break}default:throw new _('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}try{return await i.subtle.generateKey(s,null!==(a=null==t?void 0:t.extractable)&&void 0!==a&&a,c)}catch(e){if("Ed25519"===s.name&&(null==e?void 0:e.name)==="NotSupportedError"&&j())return s={name:"NODE-ED25519",namedCurve:"NODE-ED25519"},await i.subtle.generateKey(s,null!==(o=null==t?void 0:t.extractable)&&void 0!==o&&o,c);throw e}}async function tB(e,t){return tF(e,t)}async function tG(e,t){return tN(e,t)}},31955:function(e,t){"use strict";/*! js-cookie v3.0.1 | MIT */function r(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)e[n]=r[n]}return e}var n=function e(t,n){function a(e,a,i){if("undefined"!=typeof document){"number"==typeof(i=r({},n,i)).expires&&(i.expires=new Date(Date.now()+864e5*i.expires)),i.expires&&(i.expires=i.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var o="";for(var s in i)i[s]&&(o+="; "+s,!0!==i[s]&&(o+="="+i[s].split(";")[0]));return document.cookie=e+"="+t.write(a,e)+o}}return Object.create({set:a,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var r=document.cookie?document.cookie.split("; "):[],n={},a=0;a<r.length;a++){var i=r[a].split("="),o=i.slice(1).join("=");try{var s=decodeURIComponent(i[0]);if(n[s]=t.read(o,s),e===s)break}catch(e){}}return e?n[e]:n}},remove:function(e,t){a(e,"",r({},t,{expires:-1}))},withAttributes:function(t){return e(this.converter,r({},this.attributes,t))},withConverter:function(t){return e(r({},this.converter,t),this.attributes)}},{attributes:{value:Object.freeze(n)},converter:{value:Object.freeze(t)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"});t.Z=n},83991:function(e){"use strict";e.exports=JSON.parse('{"f":[{"messages":[{"role":"system","content":"You are a marketing expert, you help the user develop marketing strategies and campaigns, conduct market research, and provide branding and advertising advice."},{"role":"user","content":"best advice?"},{"role":"assistant","content":"The best advice I could give for marketing is to know your target audience inside and out. You must understand their needs, interests, behaviors, and pain points to create effective marketing strategies that resonate with them. Additionally, keep track of your metrics and analyze your data regularly to gauge your success and adjust your approach if necessary. Finally, always stay up-to-date with the latest marketing trends and technologies to stay ahead of the competition.","usage":{"prompt_tokens":42,"completion_tokens":87,"total_tokens":129},"finish":"stop"}],"chatTitle":"(Example) Marketing Advice","model":"gpt-3.5-turbo","systemMessage":"You are a marketing expert, you help the user develop marketing strategies and campaigns, conduct market research, and provide branding and advertising advice.","character":{"id":"marketing_expert","title":"Marketing Expert","instruction":"You are a marketing expert, you help the user develop marketing strategies and campaigns, conduct market research, and provide branding and advertising advice.","description":"A marketing expert who can help you develop effective marketing strategies and campaigns, conduct market research, and provide branding and advertising advice.","color":"#F5F5F5"},"chatID":"bcf4b82b-d6fd-46e9-b1d7-026a7b7190cd","updatedAt":"2023-03-11T02:58:19.665Z"},{"messages":[{"role":"system","content":"You are a standup comedian, you make people laugh with your satire, jokes and humor. You answer everything in a humorous way to cheer the user up. Use satire and make fun of everything the user says in a positive way."},{"role":"user","content":"yo!"},{"role":"assistant","content":"Hey there, Mr. Yo! Is that some sort of new yoghurt brand or are you just excited to see me?","usage":{"prompt_tokens":61,"completion_tokens":28,"total_tokens":89},"finish":"stop"}],"chatTitle":"(Example) Chat with comedian","model":"gpt-3.5-turbo","systemMessage":"You are a standup comedian, you make people laugh with your satire, jokes and humor. You answer everything in a humorous way to cheer the user up. Use satire and make fun of everything the user says in a positive way.","character":{"id":"standup_comedian","title":"Standup Comedian","instruction":"You are a standup comedian, you make people laugh with your satire, jokes and humor. You answer everything in a humorous way to cheer the user up. Use satire and make fun of everything the user says in a positive way.","description":"A standup comedian who can make you laugh with their jokes and humor.","color":"#F0FFF0"},"chatID":"cb9cd659-131a-4451-bda2-04f748c8fda2","updatedAt":"2023-03-11T02:57:36.557Z"},{"messages":[{"role":"system","content":"You are ChatGPT, a large language model trained by OpenAI."},{"role":"user","content":"list some good dot com domain names for a todo list app"},{"role":"assistant","content":"1. TaskGrid.com\\n2. TodoHive.com\\n3. TaskSpot.com\\n4. ListMate.com\\n5. TodoAce.com\\n6. TaskZenith.com\\n7. ListifyNow.com\\n8. TodoNexus.com\\n9. TaskCraze.com\\n10. ListLlama.com","usage":{"prompt_tokens":39,"completion_tokens":68,"total_tokens":107},"finish":"stop"}],"chatTitle":"(Example) Generating domain names","model":"gpt-3.5-turbo","systemMessage":"You are ChatGPT, a large language model trained by OpenAI.","character":null,"chatID":"dbaa830d-8658-4fcd-aa10-17e3f83fc231","updatedAt":"2023-03-11T02:57:24.561Z"},{"messages":[{"role":"system","content":"You are ChatGPT, a large language model trained by OpenAI."},{"role":"user","content":"Fix all the grammar errors in the text below. Only fix grammar errors, do not change the text style.\\n\\nI love AI a very many"},{"role":"assistant","content":"I love AI very much.","usage":{"prompt_tokens":55,"completion_tokens":8,"total_tokens":63},"finish":null}],"chatTitle":"(Example) Fix grammar errors","model":"gpt-3.5-turbo","systemMessage":"You are ChatGPT, a large language model trained by OpenAI.","character":null,"chatID":"48e25eea-5655-4184-8ef7-1f0f29f2b612","updatedAt":"2023-03-11T02:57:23.913Z"}]}')}},function(e){var t=function(t){return e(e.s=t)};e.O(0,[774,179],function(){return t(91118),t(90387)}),_N_E=e.O()}]);